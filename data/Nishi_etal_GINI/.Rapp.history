ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = (ndataAX$cumulativePayoff)^(1/2) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")
ldataAXs
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")
ndataBX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = (ndataBX$cumulativePayoff)^(1/2) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = (ndataCX$cumulativePayoff)^(1/2) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = (ndataDX$cumulativePayoff)^(1/2) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")
ndataCX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = (ndataCX$cumulativePayoff)^(1/2) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
A_gini = 0.01*round(ndata4[ndata4$game == 10,"gini_all"]*100)#
B_gini = 0.01*round(ndata4[ndata4$game == 78,"gini_all"]*100)#
C_gini = 0.01*round(ndata4[ndata4$game == 30,"gini_all"]*100)#
D_gini = 0.01*round(ndata4[ndata4$game == 41,"gini_all"]*100)#
#
#Import the data#
library(igraph)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
#Round 0. Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = (ndataAX$cumulativePayoff)^(1/2) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = (ndataBX$cumulativePayoff)^(1/2) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = (ndataCX$cumulativePayoff)^(1/2) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = (ndataDX$cumulativePayoff)^(1/2) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
#Round 0. Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = (ndataAX$cumulativePayoff)^(1/2) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = (ndataBX$cumulativePayoff)^(1/2) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = (ndataCX$cumulativePayoff)^(1/2) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = (ndataDX$cumulativePayoff)^(1/2) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
#Round 0. Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = (ndataAX$cumulativePayoff)^(1/2) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = (ndataBX$cumulativePayoff)^(1/2) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = (ndataCX$cumulativePayoff)^(1/2) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = (ndataDX$cumulativePayoff)^(1/2) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = (ndataAX$cumulativePayoff)^(1/2) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = (ndataBX$cumulativePayoff)^(1/2) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = (ndataCX$cumulativePayoff)^(1/2) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = (ndataDX$cumulativePayoff)^(1/2) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0.5)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")
layoutB1
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec)
plot.igraph(ldataBXs,#
layout = layoutB1)
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black")
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec)
ndataBX$size_vec
mdataBX$cumulativePayoff
ndataBX$cumulativePayoff
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = -0.25)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,2.25,1.25))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",i), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(1.25,1.25,1.25,1.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
i = 0 #
print(i)
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0,0,0,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,0.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
A_gini = 0.01*round(ndata4[ndata4$game == 10,"gini_all"]*100)#
B_gini = 0.01*round(ndata4[ndata4$game == 78,"gini_all"]*100)#
C_gini = 0.01*round(ndata4[ndata4$game == 30,"gini_all"]*100)#
D_gini = 0.01*round(ndata4[ndata4$game == 41,"gini_all"]*100)#
#
#Import the data#
library(igraph)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,0.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.4, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,0.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=0.25, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0.4, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,1.5,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1.5, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,1.5,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.6, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,1.5,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,1.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.25,0.25,1.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.2, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.5, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.5,0.25,1.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.75,0.25,1.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,-0.5))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,-0.25))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=0, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i==10,paste0("Round  ",i),paste0("Round ",i)), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=1, adj=1.2, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=1, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=1, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
nchar(i)
paste0("Gini = ",C_gini[i+1])
ifelse(nchar(C_gini[i+1])==4,paste0("Gini = ",C_gini[i+1]),0,0)
nchar(C_gini[i+1])
ifelse(nchar(C_gini[i+1])==4,paste0("Gini = ",C_gini[i+1]),0)
A_gini = 0.01*round(ndata4[ndata4$game == 10,"gini_all"]*100)#
B_gini = 0.01*round(ndata4[ndata4$game == 78,"gini_all"]*100)#
C_gini = 0.01*round(ndata4[ndata4$game == 30,"gini_all"]*100)#
D_gini = 0.01*round(ndata4[ndata4$game == 41,"gini_all"]*100)
A_gini
A_gini = as.character(0.01*round(ndata4[ndata4$game == 10,"gini_all"]*100))
A_gini
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all2)==4, as.character(ndata4$gini_all),#
						ifelse(nchar(ndata4$gini_all2)==3, paste0(as.character(ndata4$gini_all),"0"),#
						ifelse(nchar(ndata4$gini_all2)==1, paste0(as.character(ndata4$gini_all),".00"),NA)))
ndata4$gini_all2 = NA#
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all2)==4, as.character(ndata4$gini_all),#
						ifelse(nchar(ndata4$gini_all2)==3, paste0(as.character(ndata4$gini_all),"0"),#
						ifelse(nchar(ndata4$gini_all2)==1, paste0(as.character(ndata4$gini_all),".00"),NA)))
ndata4$gini_all1 = 0.01*round(ndata4$gini_all*100)#
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all1)==4, as.character(ndata4$gini_all1),#
						ifelse(nchar(ndata4$gini_all1)==3, paste0(as.character(ndata4$gini_all1),"0"),#
						ifelse(nchar(ndata4$gini_all1)==1, paste0(as.character(ndata4$gini_all1),".00"),NA)))
ndata4$gini_all2
ndata4[ndata4$game == 10,c("round","gini_all2")]
ndata4[ndata4$game == 10,"gini_all2"]
A_gini = ndata4[ndata4$game == 10,"gini_all2"]#
B_gini = ndata4[ndata4$game == 78,"gini_all2"]#
C_gini = ndata4[ndata4$game == 30,"gini_all2"]#
D_gini = ndata4[ndata4$game == 41,"gini_all2"]
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1600, height=1600, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1280, height=720, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1280, height=720, res=500) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1280, height=720, res=300) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1280, height=720, res=300) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
720/1600
500*0.45
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=720, height=720, res=250) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=720, height=720, res=250) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0("N",ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0("N",ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0("N",ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0("N",ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata
dim(ndata)
dim(ldata)
head(ndata)
i=1
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1
ndataAX
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.kamada.kawai(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.kamada.kawai(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.kamada.kawai(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.kamada.kawai(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1025.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.kamada.kawai(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.kamada.kawai(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.kamada.kawai(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.kamada.kawai(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1025.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
ndata4$gini_all1 = 0.01*round(ndata4$gini_all*100)#
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all1)==4, as.character(ndata4$gini_all1),#
						ifelse(nchar(ndata4$gini_all1)==3, paste0(as.character(ndata4$gini_all1),"0"),#
						ifelse(nchar(ndata4$gini_all1)==1, paste0(as.character(ndata4$gini_all1),".00"),NA)))#
#
A_gini = ndata4[ndata4$game == 10,"gini_all2"]#
B_gini = ndata4[ndata4$game == 78,"gini_all2"]#
C_gini = ndata4[ndata4$game == 30,"gini_all2"]#
D_gini = ndata4[ndata4$game == 41,"gini_all2"]#
#
#Import the data#
library(igraph)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 2.5, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")
ldataA0
layoutA1
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(1234); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(1234); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(1234); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(1234); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:7) { #
#
ndataAX = ndataS[ndataS$game == 10 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS[ndataS$game == 78 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS[ndataS$game == 30 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS[ndataS$game == 41 & ndataS$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
layoutB1
ndataBX
ldataBX
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))
layoutB1 = layout.circle(ldataBXs,params=list(niter=10000,start=layoutB1))
layoutB1
ldataBX
ndataBX
ndataS[ndataS$game == 78 & ndataS$round==6,c("id","cumulativePayoff","initScore","behavior")] ##
ndataS[ndataS$game == 78 & ndataS$round==7,c("id","cumulativePayoff","initScore","behavior")] ##
ndataS[ndataS$game == 78 & ndataS$round==8,c("id","cumulativePayoff","initScore","behavior")]
data = ndataS[ndataS$game == 78 & ndataS$round==6,c("id","cumulativePayoff","initScore","behavior")]
data
data[data$behavior==" ",]
data[is.null(data$behavior)==1,]
data[is.na(data$behavior)==1,]
data[data$behavior=="C",]
data[data$behavior=="D",]
head(ndataS)
ndataS1_10 = ndataS[ndataS$behavior %in% c("C","D"),]
head(ndataS1_10)
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
ndata4$gini_all1 = 0.01*round(ndata4$gini_all*100)#
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all1)==4, as.character(ndata4$gini_all1),#
						ifelse(nchar(ndata4$gini_all1)==3, paste0(as.character(ndata4$gini_all1),"0"),#
						ifelse(nchar(ndata4$gini_all1)==1, paste0(as.character(ndata4$gini_all1),".00"),NA)))#
#
A_gini = ndata4[ndata4$game == 10,"gini_all2"]#
B_gini = ndata4[ndata4$game == 78,"gini_all2"]#
C_gini = ndata4[ndata4$game == 30,"gini_all2"]#
D_gini = ndata4[ndata4$game == 41,"gini_all2"]#
#
#Import the data#
library(igraph)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
ndataS1_10 = ndataS[ndataS$behavior %in% c("C","D"),]#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 78 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:7) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 78 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
lyoutB1
layoutB1
ndataB1
ndataBX
ldataBX
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 78 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 78 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:6) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 78 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 78 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
data_round0 = ndata4[ndata4$round==0,c("game","all","Visible","n_par","gmd_all","gini_all","cumulativePayoff_all","behavior_all")]#
colnames(data_round0) = c("game","all","Visible","n0","gmd0","gini0","wealth0","coop0")#
data_round10 = ndata4[ndata4$round==10,c("game","n_par","gmd_all","gini_all","cumulativePayoff_all","behavior_all")]#
colnames(data_round10) = c("game","n10","gmd10","gini10","wealth10","coop10")#
data_rounds = merge(x=data_round0,y=data_round10,all=TRUE,by="game")#
data_rounds = data_rounds[order(data_rounds$all),]#
data_rounds[data_rounds$Visible=="Invisible" & data_rounds$all == "500_500_50",]#
data_rounds[data_rounds$Visible=="Invisible" & data_rounds$all == "1150_200_30",]#
data_rounds[data_rounds$Visible=="Visible" & data_rounds$all == "500_500_50",]#
data_rounds[data_rounds$Visible=="Visible" & data_rounds$all == "1150_200_30",]
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
ndata4$gini_all1 = 0.01*round(ndata4$gini_all*100)#
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all1)==4, as.character(ndata4$gini_all1),#
						ifelse(nchar(ndata4$gini_all1)==3, paste0(as.character(ndata4$gini_all1),"0"),#
						ifelse(nchar(ndata4$gini_all1)==1, paste0(as.character(ndata4$gini_all1),".00"),NA)))#
#
A_gini = ndata4[ndata4$game == 10,"gini_all2"]#
B_gini = ndata4[ndata4$game == 52,"gini_all2"]#
C_gini = ndata4[ndata4$game == 30,"gini_all2"]#
D_gini = ndata4[ndata4$game == 41,"gini_all2"]#
#
#Import the data#
library(igraph)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
ndataS1_10 = ndataS[ndataS$behavior %in% c("C","D"),]#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 52 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 52 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 52 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 52 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
ndata4$gini_all1 = 0.01*round(ndata4$gini_all*100)#
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all1)==4, as.character(ndata4$gini_all1),#
						ifelse(nchar(ndata4$gini_all1)==3, paste0(as.character(ndata4$gini_all1),"0"),#
						ifelse(nchar(ndata4$gini_all1)==1, paste0(as.character(ndata4$gini_all1),".00"),NA)))#
#
A_gini = ndata4[ndata4$game == 10,"gini_all2"]#
B_gini = ndata4[ndata4$game == 44,"gini_all2"]#
C_gini = ndata4[ndata4$game == 30,"gini_all2"]#
D_gini = ndata4[ndata4$game == 41,"gini_all2"]#
#
#Import the data#
library(igraph)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
ndataS1_10 = ndataS[ndataS$behavior %in% c("C","D"),]#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 44 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 44 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 44 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 44 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 44 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 44 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 44 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 44 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 44 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 44 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 44 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 44 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round  ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 44 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 44 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round  ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 44 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 44 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round   ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
ndata4$gini_all1 = 0.01*round(ndata4$gini_all*100)#
ndata4$gini_all2 = ifelse(nchar(ndata4$gini_all1)==4, as.character(ndata4$gini_all1),#
						ifelse(nchar(ndata4$gini_all1)==3, paste0(as.character(ndata4$gini_all1),"0"),#
						ifelse(nchar(ndata4$gini_all1)==1, paste0(as.character(ndata4$gini_all1),".00"),NA)))#
#
A_gini = ndata4[ndata4$game == 10,"gini_all2"]#
B_gini = ndata4[ndata4$game == 44,"gini_all2"]#
C_gini = ndata4[ndata4$game == 30,"gini_all2"]#
D_gini = ndata4[ndata4$game == 41,"gini_all2"]#
#
#Import the data#
library(igraph)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
ndataS1_10 = ndataS[ndataS$behavior %in% c("C","D"),]#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata#
#
###############################################################################################
#DataA0 (Round 0)#
#A0-1. Node (vertex) data#
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 44 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 44 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round   ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 44 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 44 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round   ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round   ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 44 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 44 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round   ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
ndataA0 = ndataS[ndataS$game == 10 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataA0$color_vec = rgb(0, 0, 0, 0.4)#
ndataA0$size_vec = (ndataA0$initScore)^(1/2)#
ndataA0$ego_id = as.numeric(substr(ndataA0$id,2,nchar(ndataA0$id)))+1#
ndataA0$label_vec = paste0("N",ndataA0$ego_id)#
#A0-2. Link (edge) data#
ldataA0 = ldata[ldata$game == 10 & ldata$round==0,c("id1","id2")]#
ldataA0$color_vec = rgb(0, 0, 0, 0.2)#
ldataA0s = graph.data.frame(ldataA0,directed=F)#
set.seed(12345); layoutA1 = layout.circle(ldataA0s,params=list(niter=1000))#
###############################################################################################
#DataB0 (Round 0)#
#B0-1. Node (vertex) data#
ndataB0 = ndataS[ndataS$game == 44 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = paste0(ifelse(ndataB0$initScore == 1150, "R","P"),ndataB0$ego_id)#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 44 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
set.seed(12345); layoutB1 = layout.circle(ldataB0s,params=list(niter=1000))#
###############################################################################################
#DataC0 (Round 0)#
#C0-1. Node (vertex) data#
ndataC0 = ndataS[ndataS$game == 30 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataC0$color_vec = rgb(0, 0, 0, 0.4)#
ndataC0$size_vec = (ndataC0$initScore)^(1/2)#
ndataC0$ego_id = as.numeric(substr(ndataC0$id,2,nchar(ndataC0$id)))+1#
ndataC0$label_vec = paste0("N",ndataC0$ego_id)#
#C0-2. Link (edge) data#
ldataC0 = ldata[ldata$game == 30 & ldata$round==0,c("id1","id2")]#
ldataC0$color_vec = rgb(0, 0, 0, 0.2)#
ldataC0s = graph.data.frame(ldataC0,directed=F)#
set.seed(12345); layoutC1 = layout.circle(ldataC0s,params=list(niter=1000))#
###############################################################################################
#DataD0 (Round 0)#
#D0-1. Node (vertex) data#
ndataD0 = ndataS[ndataS$game == 41 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataD0$color_vec = rgb(0, 0, 0, 0.4)#
ndataD0$size_vec = (ndataD0$initScore)^(1/2)#
ndataD0$ego_id = as.numeric(substr(ndataD0$id,2,nchar(ndataD0$id)))+1#
ndataD0$label_vec = paste0(ifelse(ndataD0$initScore == 1150, "R","P"),ndataD0$ego_id)#
#D0-2. Link (edge) data#
ldataD0 = ldata[ldata$game == 41 & ldata$round==0,c("id1","id2")]#
ldataD0$color_vec = rgb(0, 0, 0, 0.2)#
ldataD0s = graph.data.frame(ldataD0,directed=F)#
set.seed(12345); layoutD1 = layout.circle(ldataD0s,params=list(niter=1000))#
#
# Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r0_1027.png", width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataA0s,#
layout = layoutA1,#
vertex.size = ndataA0$size_vec, vertex.label = ndataA0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataA0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataA0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(paste0("Round   ",0), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataB0s,#
layout = layoutB1,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataC0s,#
layout = layoutC1,#
vertex.size = ndataC0$size_vec, vertex.label = ndataC0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataC0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataC0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataD0s,#
layout = layoutD1,#
vertex.size = ndataD0$size_vec, vertex.label = ndataD0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataD0$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataD0$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
###############################################################################################
#DataAX (Rounds 1-10)#
#AX-1. Node (vertex) data#
for (i in 1:10) { #
#
ndataAX = ndataS1_10[ndataS1_10$game == 10 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataAX = ndataAX[ndataAX$behavior %in% c("C","D"),]#
ndataAX$color_vec = ifelse(ndataAX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataAX$size_vec = ifelse(ndataAX$cumulativePayoff>0, (ndataAX$cumulativePayoff)^(1/2),0) ##
ndataAX$ego_id = as.numeric(substr(ndataAX$id,2,nchar(ndataAX$id)))+1#
ndataAX$label_vec = paste0("N",ndataAX$ego_id)#
#AX-2. Link (edge) data#
ldataAX = ldata[ldata$game == 10 & ldata$round==i & ldata$id1 %in% ndataAX$id & ldata$id2 %in% ndataAX$id,c("id1","id2")] ##
ldataAX$color_vec = rgb(0, 0, 0, 0.2)#
ldataAXs = graph.data.frame(ldataAX,directed=F)#
layoutA1 = layout.circle(ldataAXs,params=list(niter=1000,start=layoutA1))#
#
ndataBX = ndataS1_10[ndataS1_10$game == 44 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataBX = ndataBX[ndataBX$behavior %in% c("C","D"),]#
ndataBX$color_vec = ifelse(ndataBX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataBX$size_vec = ifelse(ndataBX$cumulativePayoff>0, (ndataBX$cumulativePayoff)^(1/2),0) ##
ndataBX$ego_id = as.numeric(substr(ndataBX$id,2,nchar(ndataBX$id)))+1#
ndataBX$label_vec = paste0(ifelse(ndataBX$initScore == 1150, "R","P"),ndataBX$ego_id)#
#BX-2. Link (edge) data#
ldataBX = ldata[ldata$game == 44 & ldata$round==i & ldata$id1 %in% ndataBX$id & ldata$id2 %in% ndataBX$id,c("id1","id2")] ##
ldataBX$color_vec = rgb(0, 0, 0, 0.2)#
ldataBXs = graph.data.frame(ldataBX,directed=F)#
layoutB1 = layout.circle(ldataBXs,params=list(niter=1000,start=layoutB1))#
#
ndataCX = ndataS1_10[ndataS1_10$game == 30 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataCX = ndataCX[ndataCX$behavior %in% c("C","D"),]#
ndataCX$color_vec = ifelse(ndataCX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataCX$size_vec = ifelse(ndataCX$cumulativePayoff>0, (ndataCX$cumulativePayoff)^(1/2),0) ##
ndataCX$ego_id = as.numeric(substr(ndataCX$id,2,nchar(ndataCX$id)))+1#
ndataCX$label_vec = paste0("N",ndataCX$ego_id)#
#CX-2. Link (edge) data#
ldataCX = ldata[ldata$game == 30 & ldata$round==i & ldata$id1 %in% ndataCX$id & ldata$id2 %in% ndataCX$id,c("id1","id2")] ##
ldataCX$color_vec = rgb(0, 0, 0, 0.2)#
ldataCXs = graph.data.frame(ldataCX,directed=F)#
layoutC1 = layout.circle(ldataCXs,params=list(niter=1000,start=layoutC1))#
#
ndataDX = ndataS1_10[ndataS1_10$game == 41 & ndataS1_10$round==i,c("id","cumulativePayoff","initScore","behavior")] ##
ndataDX = ndataDX[ndataDX$behavior %in% c("C","D"),]#
ndataDX$color_vec = ifelse(ndataDX$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataDX$size_vec = ifelse(ndataDX$cumulativePayoff>0, (ndataDX$cumulativePayoff)^(1/2),0) ##
ndataDX$ego_id = as.numeric(substr(ndataDX$id,2,nchar(ndataDX$id)))+1#
ndataDX$label_vec = paste0(ifelse(ndataDX$initScore == 1150, "R","P"),ndataDX$ego_id)#
#DX-2. Link (edge) data#
ldataDX = ldata[ldata$game == 41 & ldata$round==i & ldata$id1 %in% ndataDX$id & ldata$id2 %in% ndataDX$id,c("id1","id2")] ##
ldataDX$color_vec = rgb(0, 0, 0, 0.2)#
ldataDXs = graph.data.frame(ldataDX,directed=F)#
layoutD1 = layout.circle(ldataDXs,params=list(niter=1000,start=layoutD1))#
#
#Visualization#
png(paste0("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/VIDEO/1027a/Fig1_r",i,"_1027.png"), width=1080, height=1080, res=400) #
par(mfrow=c(2,2),mar=c(0.9,0.25,1.75,0))#
#
plot.igraph(ldataAXs,#
layout = layoutA1,#
vertex.size = ndataAX$size_vec, vertex.label = ndataAX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataAX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataAX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",A_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Invisible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
mtext("No initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
mtext(ifelse(i == 10,paste0("Round ",i),paste0("Round   ",i)), side=3, line=0.95, adj=1.25, cex=0.75, col="black")#
#
plot.igraph(ldataBXs,#
layout = layoutB1,#
vertex.size = ndataBX$size_vec, vertex.label = ndataBX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataBX$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataBX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",B_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("High initial inequality", side=3, line=0, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataCXs,#
layout = layoutC1,#
vertex.size = ndataCX$size_vec, vertex.label = ndataCX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataCX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataCX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",C_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
mtext("Visible condition", side=2, line=-0.6, adj=0.5, cex=0.75, col="black")#
#
plot.igraph(ldataDXs,#
layout = layoutD1,#
vertex.size = ndataDX$size_vec, vertex.label = ndataDX$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataDX$color_vec, vertex.frame.color = "grey20", #
edge.width = 0.5, edge.color = ldataDX$color_vec,#
margin = 0)#
mtext(paste0("Gini = ",D_gini[i+1]), side=1, line=-0.1, adj=0.5, cex=0.75, col="blue")#
#
dev.off()#
#
print(i)#
}
exp(-0.31804445)
exp(0.1231708)
Step 1: Importing packages #
library(reldist)#
library(Zelig)#
library(ggplot2)#
library(grid)#
#
#Step 2: Multiple plots at ggplot2 #
	multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {#
	  require(grid)#
#
	  # Make a list from the ... arguments and plotlist#
	  plots <- c(list(...), plotlist)#
#
	  numPlots = length(plots)#
#
	  # If layout is NULL, then use 'cols' to determine layout#
	  if (is.null(layout)) {#
	    # Make the panel#
	    # ncol: Number of columns of plots#
	    # nrow: Number of rows needed, calculated from # of cols#
	    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),#
	                    ncol = cols, nrow = ceiling(numPlots/cols))#
	  }#
#
	 if (numPlots==1) {#
	    print(plots[[1]])#
#
	  } else {#
	    # Set up the page#
	    grid.newpage()#
	    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))#
#
	    # Make each plot, in the correct location#
	    for (i in 1:numPlots) {#
	      # Get the i,j matrix positions of the regions that contain this subplot#
	      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))#
#
	      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,#
	                                      layout.pos.col = matchidx$col))#
	    }#
	  }#
	}#
#
#DATA1: Average-session-level data (n=88)#
ndata8 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata8_0527.csv",stringsAsFactors=FALSE)#
ndata8$gini_n = as.numeric(ndata8$GINI == "Low") + 2*as.numeric(ndata8$GINI == "High")#
ndata8$GINIn = as.factor(0.2*as.numeric(ndata8$GINI == "Low") + 0.4*as.numeric(ndata8$GINI == "High"))#
ndata8$GINIn2 = as.numeric(0.2*as.numeric(ndata8$GINI == "Low") + 0.4*as.numeric(ndata8$GINI == "High"))#
ndata8$Visible = ifelse(ndata8$Visible == "2.Invisible", "Invisible","Visible") #
#
#DATA1b: Average-session-level data (n=110)#
n2data8 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/n2data8_0527.csv",stringsAsFactors=FALSE)#
n2data8$gini_n = as.numeric(n2data8$GINI == "Low_Poor") + 2*as.numeric(n2data8$GINI == "Low_Rich") + 3*as.numeric(n2data8$GINI == "High_Poor") + 4*as.numeric(n2data8$GINI == "High_Rich")#
#
#DATA2: Session-level data (n=880)#
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
ndata4_2 = ndata4[ndata4$round == 10,]#
colnames(ndata4_2)[9:15] = paste0("r10_",colnames(ndata4_2)[9:15])#
#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "None","gini_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "Low","gini_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "High","gini_all"])#
#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "None","gmd_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "Low","gmd_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "High","gmd_all"])#
#
summary(ndata4$n_par)#
summary(ndata4$behavior_all)#
summary(ndata4$degree_all)#
summary(ndata4$cumulativePayoff_all)#
summary(ndata4$gmd_all)#
summary(ndata4$gini_all)#
#
#DATA3: Lag coopeation data#
mdata3 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/mdata3_0513.csv",stringsAsFactors=FALSE) #all (50,700)#
mdata3$a_m_e_wealth = mdata3$local_avg_wealth - mdata3$e_cumulativePayoff#
mdata3$condition = NA #
mdata3[mdata3$scoreA == 500 & mdata3$showScore == "true",]$condition = "Visible, None"#
mdata3[mdata3$scoreA %in% c(700,850) & mdata3$showScore == "true",]$condition = "Visible, Low"#
mdata3[mdata3$scoreA == 1150 & mdata3$showScore == "true",]$condition = "Visible, High"#
mdata3[mdata3$scoreA == 500 & mdata3$showScore == "false",]$condition = "Invisible, None"#
mdata3[mdata3$scoreA %in% c(700,850) & mdata3$showScore == "false",]$condition = "Invisible, Low"#
mdata3[mdata3$scoreA == 1150 & mdata3$showScore == "false",]$condition = "Invisible, High"#
#
summary(mdata3[mdata3$round==10,"cumulativePayoff"])#
#
#ABM Data import#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/ABM/ABM_result_0617a.RData") #
ABM_result$round_j = NA#
ABM_result[ABM_result$GINI == 0,"round_j"] = ABM_result[ABM_result$GINI == 0,"round"] - 0.05#
ABM_result[ABM_result$GINI == 0.2,"round_j"] = ABM_result[ABM_result$GINI == 0.2,"round"] + 0.0#
ABM_result[ABM_result$GINI == 0.4,"round_j"] = ABM_result[ABM_result$GINI == 0.4,"round"] + 0.05#
ABM_result$GINI = as.factor(ABM_result$GINI)#
#
ABM_result_normal = ABM_result[ABM_result$Category=="All",]#
ABM_result_strat = ABM_result[(ABM_result$Category=="All" & ABM_result$GINI==0) | (ABM_result$Category %in% c("rich","poor") & ABM_result$GINI %in% c(0.2,0.4)),]#
#
ABM_result_strat$Category2 = NA#
ABM_result_strat[ABM_result_strat$GINI==0 & ABM_result_strat$Category=="All",]$Category2 = "None"#
ABM_result_strat[ABM_result_strat$GINI==0.2 & ABM_result_strat$Category=="rich",]$Category2 = "Low_Rich"#
ABM_result_strat[ABM_result_strat$GINI==0.2 & ABM_result_strat$Category=="poor",]$Category2 = "Low_Poor"#
ABM_result_strat[ABM_result_strat$GINI==0.4 & ABM_result_strat$Category=="rich",]$Category2 = "High_Rich"#
ABM_result_strat[ABM_result_strat$GINI==0.4 & ABM_result_strat$Category=="poor",]$Category2 = "High_Poor"#
ABM_result_strat$gini_n = as.numeric(ABM_result_strat$Category2 == "Low_Poor") + 2*as.numeric(ABM_result_strat$Category2 == "Low_Rich") + 3*as.numeric(ABM_result_strat$Category2 == "High_Poor") + 4*as.numeric(ABM_result_strat$Category2 == "High_Rich")
suppressMessages(library(igraph))#
#
suppressMessages(library(reldist)) # for gini calculation#
suppressMessages(library(boot)) # for inv.logit calculation #
#
#Two prefixed functions#
#rank#
rank1 = function(x) {rank(x,na.last=NA,ties.method="average")[1]} #a smaller value has a smaller rank.#
#gini mean difference (a.k.a. mean difference: please refer to https://stat.ethz.ch/pipermail/r-help/2003-April/032782.html)#
gmd = function(x) { #
    x1 = na.omit(x)#
   	n = length(x1)#
	tmp = 0#
    for (i in 1:n) {#
       for (j in 1:n) {#
          tmp <- tmp + abs(x1[i]-x1[j])#
       }#
    }#
	answer = tmp/(n*n)#
    return(answer)#
 	}
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
data_round0 = ndata4[ndata4$round==0,c("game","all","Visible","n_par","gmd_all","gini_all","cumulativePayoff_all","behavior_all")]#
colnames(data_round0) = c("game","all","Visible","n0","gmd0","gini0","wealth0","coop0")#
data_round10 = ndata4[ndata4$round==10,c("game","n_par","gmd_all","gini_all","cumulativePayoff_all","behavior_all")]#
colnames(data_round10) = c("game","n10","gmd10","gini10","wealth10","coop10")#
data_rounds = merge(x=data_round0,y=data_round10,all=TRUE,by="game")#
data_rounds = data_rounds[order(data_rounds$all),]#
data_rounds[data_rounds$Visible=="Invisible" & data_rounds$all == "500_500_50",]#
data_rounds[data_rounds$Visible=="Invisible" & data_rounds$all == "1150_200_30",]#
data_rounds[data_rounds$Visible=="Visible" & data_rounds$all == "500_500_50",]#
data_rounds[data_rounds$Visible=="Visible" & data_rounds$all == "1150_200_30",]#
#
#Selected data:#
#DataA: Inv, GINI = 0.0: Session 10#
data_rounds[data_rounds$game== 10,]#
#DataB: Inv, GINI = 0.4: Session 78#
data_rounds[data_rounds$game== 44,]#
#DataC: Vis, GINI = 0.0: Session 30#
data_rounds[data_rounds$game== 30,]#
#DataD: Vis, GINI = 0.4: Session 41#
data_rounds[data_rounds$game== 41,]#
#
#Import the data#
library(igraph)#
library(grDevices)#
col2rgb("orange", alpha = FALSE)#
#
#Node data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/node_0312.Rdata") #ndata#
prev_ndata = ndata[,c("game","id","round","behavior")]#
prev_ndata$round = prev_ndata$round + 1#
colnames(prev_ndata) = c("game","id","round","prev_coop")#
ndataS = merge(x=ndata,y=prev_ndata,all.x=TRUE,all.y=FALSE,by=c("game","id","round"))#
#Link data#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/link_0312.Rdata") #ldata
ndataB0 = ndataS[ndataS$game == 44 & ndataS$round==0,c("id","cumulativePayoff","initScore","prev_coop")]#
ndataB0$color_vec = rgb(0, 0, 0, 0.4)#
ndataB0$size_vec = (ndataB0$initScore)^(1/2)#
ndataB0$ego_id = as.numeric(substr(ndataB0$id,2,nchar(ndataB0$id)))+1#
ndataB0$label_vec = ifelse(ndataB0$initScore == 1150, "R","P")#
#B0-2. Link (edge) data#
ldataB0 = ldata[ldata$game == 44 & ldata$round==0,c("id1","id2")]#
ldataB0$color_vec = rgb(0, 0, 0, 0.2)#
ldataB0s = graph.data.frame(ldataB0,directed=F)#
#B0-3. Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/network/Fig1_B0_1028.png", width=500, height=500, res=500) #
par(mar=c(0,0,0,0))#
plot(ldataB0s,#
layout = layout.kamada.kawai,#
vertex.size = ndataB0$size_vec, vertex.label = ndataB0$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB0$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB0$color_vec,#
margin = 0)#
dev.off()	#
###############################################################################################
#DataB10 (Round 10)#
#B10-1. Node (vertex) data#
ndataB10 = ndataS[ndataS$game == 44 & ndataS$round==10,c("id","cumulativePayoff","initScore","behavior")] ##
ndataB10 = ndataB10[ndataB10$behavior %in% c("C","D"),]#
ndataB10$color_vec = ifelse(ndataB10$behavior == "C", rgb(0.2, 0, 0.5, 0.5), rgb(0.5, 0, 0, 0.5)) ##
ndataB10$size_vec = (ndataB10$cumulativePayoff)^(1/2) ##
ndataB10$ego_id = as.numeric(substr(ndataB10$id,2,nchar(ndataB10$id)))+1#
ndataB10$label_vec = ifelse(ndataB10$initScore == 1150, "R","P")#
#B10-2. Link (edge) data#
ldataB10 = ldata[ldata$game == 44 & ldata$round==10 & ldata$id1 %in% ndataB10$id & ldata$id2 %in% ndataB10$id,c("id1","id2")] ##
ldataB10$color_vec = rgb(0, 0, 0, 0.2)#
ldataB10s = graph.data.frame(ldataB10,directed=F)#
#B10-3. Visualization#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/network/Fig1_B10_1028.png", width=500, height=500, res=500) #
par(mar=c(0,0,0,0))#
plot(ldataB10s,#
layout = layout.kamada.kawai,#
vertex.size = ndataB10$size_vec, vertex.label = ndataB10$label_vec, vertex.label.cex = 0.25, vertex.label.color = "black",#
vertex.label.family = "Helvetica", vertex.color = ndataB10$color_vec, vertex.frame.color = NA, #
edge.width = 0.5, edge.color = ldataB10$color_vec,#
margin = 0)#
dev.off()
data_rounds[data_rounds$game== 30,]
data_rounds[data_rounds$game== 44,]
data_category = c(1,2,3)#
data_gini = c("None","Low","High")#
data_beta_gmd = c( -124.6306   ,  -28.24961  , 172.7457   )#
data_se_gmd = c(  53.07078   ,48.40922   ,  85.46358  ) #
data_beta_gini = c( 0.0185086 ,  0.0386558  ,  0.1039027  )#
data_se_gini = c(  0.0244563   ,   0.018878  ,  0.036063 ) #
#
tab2 = data.frame(Category1=data_category,GINI=data_gini,r10_gmd_avg=data_beta_gmd,r10_gmd_se=data_se_gmd,r10_gini_avg=data_beta_gini,r10_gini_se=data_se_gini)#
tab2$Category1 = as.numeric(tab2$Category1)#
#
fig2a = ggplot(ndata8, aes(x=round_j,y=gini_avg,linetype=Visible,color=GINIn)) + ylim(-0.025,0.65) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("GINI") + xlab("Round") + #
theme(legend.position=c(0.75,0.125),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gini_avg-gini_se,ymax=gini_avg+gini_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.2) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on\nthe change in GINI\n(Rounds 6-10)") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.07,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.08,label="*",size=4.5) + #
annotate("text",x=3,y=0.18,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.21, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
data_category = c(1,2,3)#
data_gini = c("None","Low","High")#
data_beta_gmd = c( -124.6306   ,  -28.24961  , 172.7457   )#
data_se_gmd = c(  53.07078   ,48.40922   ,  85.46358  ) #
data_beta_gini = c( 0.0185086 ,  0.0386558  ,  0.1039027  )#
data_se_gini = c(  0.0244563   ,   0.018878  ,  0.036063 ) #
#
tab2 = data.frame(Category1=data_category,GINI=data_gini,r10_gmd_avg=data_beta_gmd,r10_gmd_se=data_se_gmd,r10_gini_avg=data_beta_gini,r10_gini_se=data_se_gini)#
tab2$Category1 = as.numeric(tab2$Category1)#
#
fig2a = ggplot(ndata8, aes(x=round_j,y=gini_avg,linetype=Visible,color=GINIn)) + ylim(-0.025,0.65) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.75,0.125),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gini_avg-gini_se,ymax=gini_avg+gini_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.15) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on\nthe change in GINI") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.07,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.08,label="*",size=4.5) + #
annotate("text",x=3,y=0.18,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.21, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
data_category = c(1,2,3)#
data_gini = c("None","Low","High")#
data_beta_gmd = c( -124.6306   ,  -28.24961  , 172.7457   )#
data_se_gmd = c(  53.07078   ,48.40922   ,  85.46358  ) #
data_beta_gini = c( 0.0185086 ,  0.0386558  ,  0.1039027  )#
data_se_gini = c(  0.0244563   ,   0.018878  ,  0.036063 ) #
#
tab2 = data.frame(Category1=data_category,GINI=data_gini,r10_gmd_avg=data_beta_gmd,r10_gmd_se=data_se_gmd,r10_gini_avg=data_beta_gini,r10_gini_se=data_se_gini)#
tab2$Category1 = as.numeric(tab2$Category1)#
#
fig2a = ggplot(ndata8, aes(x=round_j,y=gini_avg,linetype=Visible,color=GINIn)) + ylim(-0.025,0.65) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.75,0.125),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gini_avg-gini_se,ymax=gini_avg+gini_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.15) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibilit\non Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.07,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.08,label="*",size=4.5) + #
annotate("text",x=3,y=0.18,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.21, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
data_category = c(1,2,3)#
data_gini = c("None","Low","High")#
data_beta_gmd = c( -124.6306   ,  -28.24961  , 172.7457   )#
data_se_gmd = c(  53.07078   ,48.40922   ,  85.46358  ) #
data_beta_gini = c( 0.0185086 ,  0.0386558  ,  0.1039027  )#
data_se_gini = c(  0.0244563   ,   0.018878  ,  0.036063 ) #
#
tab2 = data.frame(Category1=data_category,GINI=data_gini,r10_gmd_avg=data_beta_gmd,r10_gmd_se=data_se_gmd,r10_gini_avg=data_beta_gini,r10_gini_se=data_se_gini)#
tab2$Category1 = as.numeric(tab2$Category1)#
#
fig2a = ggplot(ndata8, aes(x=round_j,y=gini_avg,linetype=Visible,color=GINIn)) + ylim(-0.025,0.65) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.75,0.125),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gini_avg-gini_se,ymax=gini_avg+gini_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.15) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibilit\non Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.07,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.08,label="*",size=4.5) + #
annotate("text",x=3,y=0.18,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.16, 0.05))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
data_category = c(1,2,3)#
data_gini = c("None","Low","High")#
data_beta_gmd = c( -124.6306   ,  -28.24961  , 172.7457   )#
data_se_gmd = c(  53.07078   ,48.40922   ,  85.46358  ) #
data_beta_gini = c( 0.0185086 ,  0.0386558  ,  0.1039027  )#
data_se_gini = c(  0.0244563   ,   0.018878  ,  0.036063 ) #
#
tab2 = data.frame(Category1=data_category,GINI=data_gini,r10_gmd_avg=data_beta_gmd,r10_gmd_se=data_se_gmd,r10_gini_avg=data_beta_gini,r10_gini_se=data_se_gini)#
tab2$Category1 = as.numeric(tab2$Category1)#
#
fig2a = ggplot(ndata8, aes(x=round_j,y=gini_avg,linetype=Visible,color=GINIn)) + ylim(-0.025,0.65) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.75,0.125),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gini_avg-gini_se,ymax=gini_avg+gini_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.15) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.07,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.08,label="*",size=4.5) + #
annotate("text",x=3,y=0.18,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.16, 0.05))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.15) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.07,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.08,label="*",size=4.5) + #
annotate("text",x=3,y=0.14,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.16, 0.05))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.17) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.07,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.08,label="*",size=4.5) + #
annotate("text",x=3,y=0.15,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.16, 0.05))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(0,0.17) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.06,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.07,label="*",size=4.5) + #
annotate("text",x=3,y=0.15,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.17, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-0.02,0.17) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.06,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.07,label="*",size=4.5) + #
annotate("text",x=3,y=0.15,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.17, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-0.02,0.17) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.06,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.07,label="*",size=4.5) + #
annotate("text",x=3,y=0.15,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(-0.02, 0.17, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-0.02,0.17) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=8) + #
annotate("text",x=1,y=0.06,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.07,label="*",size=4.5) + #
annotate("text",x=3,y=0.15,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.17, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
figS6a = ggplot(ndata8, aes(x=round_j,y=gmd_avg,linetype=Visible,color=GINIn)) + ylim(-0.01,1350) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.25,0.725),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gmd_avg-gmd_se,ymax=gmd_avg+gmd_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2a = ggplot(ndata8, aes(x=round_j,y=gini_avg,linetype=Visible,color=GINIn)) + ylim(-0.025,0.65) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.75,0.125),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gini_avg-gini_se,ymax=gini_avg+gini_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-0.02,0.17) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="B",size=10) + #
annotate("text",x=1,y=0.06,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.07,label="*",size=4.5) + #
annotate("text",x=3,y=0.15,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.17, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
fig2b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gini_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-0.02,0.17) + #
geom_errorbar(aes(ymin=r10_gini_avg-r10_gini_se,ymax=r10_gini_avg+r10_gini_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility on Gini") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1.25,hjust=-1,label="B",size=10) + #
annotate("text",x=1,y=0.06,label="n.s.",size=3.5) + #
annotate("text",x=2,y=0.07,label="*",size=4.5) + #
annotate("text",x=3,y=0.15,label="**",size=4.5) + #
scale_y_continuous(breaks = seq(0, 0.17, 0.1))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig2_1028.png", width=2000, height=2000, res=400) #
fig2a#
print(fig2b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.75))#
dev.off()
figS6a = ggplot(ndata8, aes(x=round_j,y=gmd_avg,linetype=Visible,color=GINIn)) + ylim(-0.01,1350) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.25,0.725),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gmd_avg-gmd_se,ymax=gmd_avg+gmd_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.25))#
dev.off()
figS6a = ggplot(ndata8, aes(x=round_j,y=gmd_avg,linetype=Visible,color=GINIn)) + ylim(-0250,1350) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.25,0.725),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gmd_avg-gmd_se,ymax=gmd_avg+gmd_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.525, height=0.4, x=0.7, y=0.25))#
dev.off()
figS6a = ggplot(ndata8, aes(x=round_j,y=gmd_avg,linetype=Visible,color=GINIn)) + ylim(-0.01,1350) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.25,0.725),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gmd_avg-gmd_se,ymax=gmd_avg+gmd_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.3, x=0.7, y=0.25))#
dev.off()
figS6a = ggplot(ndata8, aes(x=round_j,y=gmd_avg,linetype=Visible,color=GINIn)) + ylim(-100,1350) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.25,0.725),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gmd_avg-gmd_se,ymax=gmd_avg+gmd_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.3, x=0.7, y=0.25))#
dev.off()
figS6a = ggplot(ndata8, aes(x=round_j,y=gmd_avg,linetype=Visible,color=GINIn)) + ylim(-100,1350) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.25,0.725),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gmd_avg-gmd_se,ymax=gmd_avg+gmd_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.3, x=0.75, y=0.275))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.265))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-330,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=370,label="*",size=10) #
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.265))#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.27))#
dev.off()
tab2
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=270,label="*",size=10) #
scale_y_continuous(breaks = seq(-300, 300, 300))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.27))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-1.2,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=10) + #
annotate("text",x=2,y=50,label="n.s",size=6) + #
annotate("text",x=3,y=270,label="*",size=10) +#
scale_y_continuous(breaks = seq(-200, 200, 200))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.27))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-200, 200, 200))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.27))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-300, 300, 300))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.27))#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.27))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-300, 350, 300))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.27))#
dev.off()
tab2
figS6a = ggplot(ndata8, aes(x=round_j,y=gmd_avg,linetype=Visible,color=GINIn)) + ylim(-150,1350) + geom_line() + theme_bw() + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.text.x=element_text(size=15),axis.text.y=element_text(size=15)) +#
scale_color_manual(values=c("skyblue","grey","orange"),name="Initial inequality",labels=c("None","Low","High"),guide=guide_legend(ncol=3)) + scale_linetype_manual(values=c("dashed", "solid"),name="Visibility",guide=guide_legend(ncol=2)) +#
ylab("Gini") + xlab("Round") + #
theme(legend.position=c(0.25,0.725),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5)) +#
annotate("text",x=-Inf,y=Inf,vjust=1.5,hjust=-1,label="A",size=10) + #
geom_errorbar(aes(ymin=gmd_avg-gmd_se,ymax=gmd_avg+gmd_se,color=GINIn),width=0,alpha=0.25) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-300, 350, 300))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.325, x=0.75, y=0.27))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-300, 350, 300))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.27))#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.28))#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.2825))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-300,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.2825))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-400, 400, 400))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.2825))#
dev.off()
ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) +#
scale_y_continuous(breaks = seq(-400, 400, 400))
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-400,400) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.2825))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-200,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.2825))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-200,250) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.2825))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-200,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.2825))#
dev.off()
figS6b = ggplot(tab2,aes(x=reorder(GINI,Category1),y=r10_gmd_avg, fill = factor(Category1))) +#
geom_bar(stat="identity",color=FALSE,name=FALSE) + ylim(-200,300) + #
geom_errorbar(aes(ymin=r10_gmd_avg-r10_gmd_se,ymax=r10_gmd_avg+r10_gmd_se),color="black",width=0,alpha=0.5) +#
theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),plot.title=element_text(vjust = -1.5,size=7.5),axis.title.x=element_text(size=7.5),axis.title.y=element_text(size=10),plot.margin=unit(c(0.1,0.1,0.1,0.1),"lines")) +#
ylab("Effect of visibility\non mean difference") + xlab(" ") +#
scale_fill_manual(values=c("skyblue","grey","orange"),guide=FALSE) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.7,label="B",size=10) +#
annotate("text",x=1,y=-200,label="*",size=8) + #
annotate("text",x=2,y=50,label="n.s",size=4) + #
annotate("text",x=3,y=270,label="*",size=8) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.282))#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.75, y=0.28))#
dev.off()
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS6_1028.png", width=2000, height=2000, res=400) #
figS6a#
print(figS6b,vp= viewport(width=0.425, height=0.35, x=0.755, y=0.281))#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Blank","Visible","Visible","Visible")#
data_category = c(1,2,3,4,1,2,3)#
data_gini = c("0.0","0.2","0.4","Blank","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nMiddle","Invisible\nHigh","Blank","Visible\nNone","Visible\nMiddle","Visible\nHigh")#
data_beta = c(0.2500772,0.2284484,-0.1051404,0,-0.3696521,0.10024,0.6332867)#
data_se = c(0.3049311,0.1316299,0.1837409,0,0.1223672,0.0732835,0.1431453) #
data_category2 = c(1,2,3,4,5,6,7)#
#
tab4a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tab4a$OR = 1/exp(as.numeric(tab4a$coef)) #
tab4a$low = 1/exp(as.numeric(tab4a$coef)-1.96*as.numeric(tab4a$se)) #
tab4a$hig = 1/exp(as.numeric(tab4a$coef)+1.96*as.numeric(tab4a$se)) #
tab4a$category = as.numeric(tab4a$category)#
tab4a$OR2 = substr(tab4a$OR,1,5)#
tab4a[4,]$OR = tab4a[4,]$OR2 =tab4a[4,]$low =tab4a[4,]$hig =-1#
#
ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
geom_point(stat="identity",name=FALSE,size=5) #
#
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.35,1.95) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.5,label="n.s.",size=6) + #
annotate("text",x=2,y=1.10,label="n.s.",size=6) + #
annotate("text",x=3,y=1.675,label="n.s.",size=6) +#
annotate("text",x=5,y=1.875,label="**",size=10) + #
annotate("text",x=6,y=1.10,label="n.s.",size=6) + #
annotate("text",x=7,y=0.725,label="***",size=10) +#
annotate("text",x=2,y=0.35,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.35,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Blank","Visible","Visible","Visible")#
data_category = c(1,2,3,4,1,2,3)#
data_gini = c("0.0","0.2","0.4","Blank","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nMiddle","Invisible\nHigh","Blank","Visible\nNone","Visible\nMiddle","Visible\nHigh")#
data_beta = c(-0.2500772,-0.2284484,0.1051404,0,0.3696521,-0.10024,-0.6332867)#
data_se = c(0.310989 ,0.1219068,0.1995712,0,0.1675825 , 0.0819548 ,0.1559763 ) #
data_category2 = c(1,2,3,4,5,6,7)#
#
tab4a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tab4a$OR = exp(as.numeric(tab4a$coef)) #
tab4a$low = exp(as.numeric(tab4a$coef)-1.96*as.numeric(tab4a$se)) #
tab4a$hig = exp(as.numeric(tab4a$coef)+1.96*as.numeric(tab4a$se)) #
tab4a$category = as.numeric(tab4a$category)#
tab4a$OR2 = substr(tab4a$OR,1,5)#
tab4a[4,]$OR = tab4a[4,]$OR2 =tab4a[4,]$low =tab4a[4,]$hig =-1#
#
ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
geom_point(stat="identity",name=FALSE,size=5) #
#
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.35,1.95) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.5,label="n.s.",size=6) + #
annotate("text",x=2,y=1.10,label="n.s.",size=6) + #
annotate("text",x=3,y=1.675,label="n.s.",size=6) +#
annotate("text",x=5,y=1.875,label="*",size=10) + #
annotate("text",x=6,y=1.10,label="n.s.",size=6) + #
annotate("text",x=7,y=0.725,label="***",size=10) +#
annotate("text",x=2,y=0.35,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.35,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.35,2.15) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.5,label="n.s.",size=6) + #
annotate("text",x=2,y=1.10,label="n.s.",size=6) + #
annotate("text",x=3,y=1.675,label="n.s.",size=6) +#
annotate("text",x=5,y=1.875,label="*",size=10) + #
annotate("text",x=6,y=1.10,label="n.s.",size=6) + #
annotate("text",x=7,y=0.725,label="***",size=10) +#
annotate("text",x=2,y=0.35,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.35,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.35,2.1) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.5,label="n.s.",size=6) + #
annotate("text",x=2,y=1.10,label="n.s.",size=6) + #
annotate("text",x=3,y=1.675,label="n.s.",size=6) +#
annotate("text",x=5,y=1.875,label="*",size=10) + #
annotate("text",x=6,y=1.10,label="n.s.",size=6) + #
annotate("text",x=7,y=0.725,label="***",size=10) +#
annotate("text",x=2,y=0.35,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.35,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.35,2.1) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.55,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.725,label="n.s.",size=6) +#
annotate("text",x=5,y=2.05,label="*",size=10) + #
annotate("text",x=6,y=1.15,label="n.s.",size=6) + #
annotate("text",x=7,y=0.75,label="***",size=10) +#
annotate("text",x=2,y=0.35,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.35,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.3,2.1) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.55,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.725,label="n.s.",size=6) +#
annotate("text",x=5,y=2.05,label="*",size=10) + #
annotate("text",x=6,y=1.15,label="n.s.",size=6) + #
annotate("text",x=7,y=0.75,label="***",size=10) +#
annotate("text",x=2,y=0.35,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.35,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.3,2.1) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.55,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.725,label="n.s.",size=6) +#
annotate("text",x=5,y=2.05,label="*",size=10) + #
annotate("text",x=6,y=1.15,label="n.s.",size=6) + #
annotate("text",x=7,y=0.75,label="***",size=10) +#
annotate("text",x=2,y=0.3,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.3,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
fig4 = ggplot(tab4a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.7787407,yend=0.7957674,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.7957674,yend=1.1108666,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.4472310,yend=0.9046203,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=6,xend=7,y=0.9046203,yend=0.5308442,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5)  +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","white","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11.5),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0.3,2.1) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange","white"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High"," ","None","Low","High")) + #
annotate("text",x=1,y=1.55,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.75,label="n.s.",size=6) +#
annotate("text",x=5,y=2.05,label="*",size=10) + #
annotate("text",x=6,y=1.15,label="n.s.",size=6) + #
annotate("text",x=7,y=0.75,label="***",size=10) +#
annotate("text",x=2,y=0.3,label="Invisible condition",size=4.5) + #
annotate("text",x=6,y=0.3,label="Visible condition",size=4.5) #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/Fig4_1028.png", width=2000, height=2000, res=400) #
fig4#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( -0.4272013 ,  -0.1900342,   0.3797943 , 0.8045521 ,  0.0105297  , -0.2112508 )#
data_se = c( 0.2388468 ,   0.158823  ,   0.3631553  ,  0.2638676  , 0.1575042  ,  0.3591493  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7a$OR = exp(as.numeric(tabS7a$coef))#
tabS7a$low = exp(as.numeric(tabS7a$coef)-as.numeric(tabS7a$se)) #
tabS7a$hig = exp(as.numeric(tabS7a$coef)+as.numeric(tabS7a$se)) #
tabS7a$category = as.numeric(tabS7a$category)#
tabS7a$OR2 = substr(tabS7a$OR,1,5)#
#
figS7a = ggplot(tabS7a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.6523322,yend=0.8269309,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.8269309,yend=1.4619838,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=2.2356949,yend=1.0105853,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.0105853,yend=0.8095710,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("A. Cooperators at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,3.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=1.15,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=2.2,label="n.s.",size=6) +#
annotate("text",x=4,y=2.85,label="**",size=10) + #
annotate("text",x=5,y=1.35,label="n.s.",size=6) + #
annotate("text",x=6,y=1.25,label="n.s.",size=6) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
#Data2#
#Fig S7b: Previous defectors #
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Low","High","None","Low","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( 0.1869984  , -0.3880653 ,  -0.215401 , -0.1444834 , -0.223932  ,  -0.9669976  )#
data_se = c(  0.5881108  , 0.3072127  ,  0.2038711  , 0.2682515  ,  0.1529806   ,  0.2377137  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7b$OR = exp(as.numeric(tabS7b$coef)) #
tabS7b$low = exp(as.numeric(tabS7b$coef)-as.numeric(tabS7b$se)) #
tabS7b$hig = exp(as.numeric(tabS7b$coef)+as.numeric(tabS7b$se)) #
tabS7b$category = as.numeric(tabS7b$category)#
tabS7b$OR2 = substr(tabS7b$OR,1,5)#
#
figS7b = ggplot(tabS7b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("B. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,3.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=2.3,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.15,label="n.s.",size=6) +#
annotate("text",x=4,y=1.25,label="n.s.",size=6) + #
annotate("text",x=5,y=1.15,label="n.s.",size=6) + #
annotate("text",x=6,y=0.55,label="***",size=10) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)
tabS7
dis(-0.5296941)
exp(-0.5296941)
inv.logit(-0.5296941)
inv.logit(-0.805)
data_vis = c(rep("Invisible",12),rep("Visible",12))#
#data_gini = c(rep(c("0.0","0.0","0.0","0.0","0.2","0.2","0.2","0.2","0.4","0.4","0.4","0.4"),2))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645  , -1.224176  ,2.119447  ,2.01562 , -0.5296941 , -0.8493965 , 1.647417 ,  2.130444 , -1.165752, -1.044851 , 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302 , 1.024681, -0.6777227,  -1.563976 , 0.9176321 , 1.250339 )#
data_se = c( 0.4644794, 0.2097434 ,  0.2125253 ,0.2046154 ,  0.3215645 ,0.1815067,  0.1739411, 0.1754515,  0.2614773 ,0.2634225, 0.2713908 , 0.3034099 ,0.1393047 ,0.2743448 , 0.1854684 , 0.332925 , 0.1473137 , 0.1422828, 0.1705616, 0.1672841 ,0.1443283 , 0.289991 , 0.2037085 , 0.3764714 ) #
#
tabS8 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)
tabS8
data_vis = c(rep("Invisible",12),rep("Visible",12))#
#data_gini = c(rep(c("0.0","0.0","0.0","0.0","0.2","0.2","0.2","0.2","0.4","0.4","0.4","0.4"),2))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(rep(c(1,1,1,1,2,2,2,2,3,3,3,3),2)) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645  , -1.224176  ,2.119447  ,2.01562 , -0.5296941 , -0.8493965 , 1.647417 ,  2.130444 , -1.165752, -1.044851 , 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302 , 1.024681, -0.6777227,  -1.563976 , 0.9176321 , 1.250339 )#
data_se = c( 0.4644794, 0.2097434 ,  0.2125253 ,0.2046154 ,  0.3215645 ,0.1815067,  0.1739411, 0.1754515,  0.2614773 ,0.2634225, 0.2713908 , 0.3034099 ,0.1393047 ,0.2743448 , 0.1854684 , 0.332925 , 0.1473137 , 0.1422828, 0.1705616, 0.1672841 ,0.1443283 , 0.289991 , 0.2037085 , 0.3764714 ) #
#
tabS8 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS8$Prob = inv.logit(as.numeric(tabS8$coef)) #
tabS8$low = inv.logit(as.numeric(tabS8$coef)-1*as.numeric(tabS8$se)) #
tabS8$hig = inv.logit(as.numeric(tabS8$coef)+1*as.numeric(tabS8$se)) #
tabS8$category = as.numeric(tabS8$category)#
tabS8$category2 = as.numeric(tabS8$category2)#
tabS8$Prob2 = substr(tabS8$Prob,1,5)#
#
tabS8c = tabS8[tabS8$Visible == "Invisible" & tabS8$prev_coop == "C",]#
tabS8d = tabS8[tabS8$Visible == "Visible" & tabS8$prev_coop == "C",]#
tabS8e = tabS8[tabS8$Visible == "Invisible" & tabS8$prev_coop == "D",]#
tabS8f = tabS8[tabS8$Visible == "Visible" & tabS8$prev_coop == "D",]#
#
figS8c = ggplot(tabS8c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("c. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS8d = ggplot(tabS8e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("d. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS8e = ggplot(tabS8d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("e. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS8f = ggplot(tabS8f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("f. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS8_0927.png", width=3500, height=5250, res=350) #
multiplot(figS8a,figS8c,figS8e,figS8b,figS8d,figS8f,cols=2, layout=NULL)#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nMiddle","Invisible\nHigh","Visible\nNone","Visible\nMiddle","Visible\nHigh")#
data_beta = c( 0.4272013 ,  0.1900342,   -0.3797943 , -0.8045521 ,  -0.0105297  , 0.2112508 )#
data_se = c( 0.2543905 , 0.1582974 ,  0.3376779 , 0.2201892 ,0.1432143 ,  0.3249751 ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS8a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS8a$OR = 1/exp(as.numeric(tabS8a$coef)) #
tabS8a$low = 1/exp(as.numeric(tabS8a$coef)-as.numeric(tabS8a$se)) #
tabS8a$hig = 1/exp(as.numeric(tabS8a$coef)+as.numeric(tabS8a$se)) #
tabS8a$category = as.numeric(tabS8a$category)#
tabS8a$OR2 = substr(tabS8a$OR,1,5)#
#
figS8a = ggplot(tabS8a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.6523322,yend=0.8269309,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.8269309,yend=1.4619838,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=2.2356949,yend=1.0105853,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.0105853,yend=0.8095710,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("a. Cooperators at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,3.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n(>1: Leading to decrease economic inequality)") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Middle","High","None","Middle","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=1.15,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=2.2,label="n.s.",size=6) +#
annotate("text",x=4,y=2.85,label="***",size=10) + #
annotate("text",x=5,y=1.35,label="n.s.",size=6) + #
annotate("text",x=6,y=1.25,label="n.s.",size=6) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
#Data2#
#Fig S8b: Previous defectors #
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Middle","High","None","Middle","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nMiddle","Invisible\nHigh","Visible\nNone","Visible\nMiddle","Visible\nHigh")#
data_beta = c( -0.1869984  , 0.3880653 ,  0.215401 , 0.1444834 , 0.223932  ,  0.9669976  )#
data_se = c( 0.5688283 , 0.363374 , 0.1828954 , 0.2644566 ,  0.1748308 ,  0.2263502 ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS8b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS8b$OR = 1/exp(as.numeric(tabS8b$coef)) #
tabS8b$low = 1/exp(as.numeric(tabS8b$coef)-as.numeric(tabS8b$se)) #
tabS8b$hig = 1/exp(as.numeric(tabS8b$coef)+as.numeric(tabS8b$se)) #
tabS8b$category = as.numeric(tabS8b$category)#
tabS8b$OR2 = substr(tabS8b$OR,1,5)#
#
figS8b = ggplot(tabS8b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("b. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,3.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n(>1: Leading to decrease economic inequality)") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Middle","High","None","Middle","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=2.3,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.15,label="n.s.",size=6) +#
annotate("text",x=4,y=1.25,label="n.s.",size=6) + #
annotate("text",x=5,y=1.15,label="n.s.",size=6) + #
annotate("text",x=6,y=0.55,label="***",size=10) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
#Data3#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
#data_gini = c(rep(c("0.0","0.0","0.0","0.0","0.2","0.2","0.2","0.2","0.4","0.4","0.4","0.4"),2))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(rep(c(1,1,1,1,2,2,2,2,3,3,3,3),2)) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645  , -1.224176  ,2.119447  ,2.01562 , -0.5296941 , -0.8493965 , 1.647417 ,  2.130444 , -1.165752, -1.044851 , 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302 , 1.024681, -0.6777227,  -1.563976 , 0.9176321 , 1.250339 )#
data_se = c( 0.4644794, 0.2097434 ,  0.2125253 ,0.2046154 ,  0.3215645 ,0.1815067,  0.1739411, 0.1754515,  0.2614773 ,0.2634225, 0.2713908 , 0.3034099 ,0.1393047 ,0.2743448 , 0.1854684 , 0.332925 , 0.1473137 , 0.1422828, 0.1705616, 0.1672841 ,0.1443283 , 0.289991 , 0.2037085 , 0.3764714 ) #
#
tabS8 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS8$Prob = inv.logit(as.numeric(tabS8$coef)) #
tabS8$low = inv.logit(as.numeric(tabS8$coef)-1*as.numeric(tabS8$se)) #
tabS8$hig = inv.logit(as.numeric(tabS8$coef)+1*as.numeric(tabS8$se)) #
tabS8$category = as.numeric(tabS8$category)#
tabS8$category2 = as.numeric(tabS8$category2)#
tabS8$Prob2 = substr(tabS8$Prob,1,5)#
#
tabS8c = tabS8[tabS8$Visible == "Invisible" & tabS8$prev_coop == "C",]#
tabS8d = tabS8[tabS8$Visible == "Visible" & tabS8$prev_coop == "C",]#
tabS8e = tabS8[tabS8$Visible == "Invisible" & tabS8$prev_coop == "D",]#
tabS8f = tabS8[tabS8$Visible == "Visible" & tabS8$prev_coop == "D",]#
#
figS8c = ggplot(tabS8c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("c. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS8d = ggplot(tabS8e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("d. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS8e = ggplot(tabS8d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("e. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS8f = ggplot(tabS8f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial GINI") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("f. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS8_0927.png", width=3500, height=5250, res=350) #
multiplot(figS8a,figS8c,figS8e,figS8b,figS8d,figS8f,cols=2, layout=NULL)#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( -0.4272013 ,  -0.1900342,   0.3797943 , 0.8045521 ,  0.0105297  , -0.2112508 )#
data_se = c( 0.2388468 ,   0.158823  ,   0.3631553  ,  0.2638676  , 0.1575042  ,  0.3591493  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7a$OR = exp(as.numeric(tabS7a$coef))#
tabS7a$low = exp(as.numeric(tabS7a$coef)-1.96*as.numeric(tabS7a$se)) #
tabS7a$hig = exp(as.numeric(tabS7a$coef)+1.96*as.numeric(tabS7a$se)) #
tabS7a$category = as.numeric(tabS7a$category)#
tabS7a$OR2 = substr(tabS7a$OR,1,5)#
#
figS7a = ggplot(tabS7a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.6523322,yend=0.8269309,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.8269309,yend=1.4619838,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=2.2356949,yend=1.0105853,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.0105853,yend=0.8095710,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("A. Cooperators at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,3.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=1.15,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=2.2,label="n.s.",size=6) +#
annotate("text",x=4,y=2.85,label="**",size=10) + #
annotate("text",x=5,y=1.35,label="n.s.",size=6) + #
annotate("text",x=6,y=1.25,label="n.s.",size=6) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
#Data2#
#Fig S7b: Previous defectors #
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Low","High","None","Low","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( 0.1869984  , -0.3880653 ,  -0.215401 , -0.1444834 , -0.223932  ,  -0.9669976  )#
data_se = c(  0.5881108  , 0.3072127  ,  0.2038711  , 0.2682515  ,  0.1529806   ,  0.2377137  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7b$OR = exp(as.numeric(tabS7b$coef)) #
tabS7b$low = exp(as.numeric(tabS7b$coef)-1.96*as.numeric(tabS7b$se)) #
tabS7b$hig = exp(as.numeric(tabS7b$coef)+1.96*as.numeric(tabS7b$se)) #
tabS7b$category = as.numeric(tabS7b$category)#
tabS7b$OR2 = substr(tabS7b$OR,1,5)#
#
figS7b = ggplot(tabS7b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("B. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,3.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=2.3,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.15,label="n.s.",size=6) +#
annotate("text",x=4,y=1.25,label="n.s.",size=6) + #
annotate("text",x=5,y=1.15,label="n.s.",size=6) + #
annotate("text",x=6,y=0.55,label="***",size=10) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
#Fig. S7c-f#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(rep(c(1,1,1,1,2,2,2,2,3,3,3,3),2)) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(rep(c(1,1,1,1,2,2,2,2,3,3,3,3),4)) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(rep(c(1,,1,2,2,2,3,3),4)) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(rep(c(1,1,2,2,2,3,3),4)) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
rep(c(1,1,2,2,2,3,3),4)
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(rep(c(1,1,2,2,3,3),4)) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645 , -1.224176 ,2.119447  ,2.01562 , -0.5296941 ,-0.8493965, 1.647417 ,  2.130444 , -1.165752, -1.044851, 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302, 1.024681 ,-0.6777227, -1.563976, 0.9176321 , 1.250339 )#
data_se = c( 0.4379345  ,  0.2510255  , 0.1963933 , 0.1946142  ,  0.3542939   , 0.2161835  , 0.1763198 ,0.1828226 ,  0.2760893  ,0.269753  ,  0.2760372 ,  0.324576  , 0.1292299,0.2921103 , 0.1821481   , 0.3807055, 0.1664283,  0.1803316 , 0.1701283 ,  0.2341324 , 0.1673656  ,  0.302745   ,  0.1970932  ,  0.3751897 ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
tabS7a
tabS7b
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( -0.4272013 ,  -0.1900342,   0.3797943 , 0.8045521 ,  0.0105297  , -0.2112508 )#
data_se = c( 0.2388468 ,   0.158823  ,   0.3631553  ,  0.2638676  , 0.1575042  ,  0.3591493  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7a$OR = exp(as.numeric(tabS7a$coef))#
tabS7a$low = exp(as.numeric(tabS7a$coef)-1.96*as.numeric(tabS7a$se)) #
tabS7a$hig = exp(as.numeric(tabS7a$coef)+1.96*as.numeric(tabS7a$se)) #
tabS7a$category = as.numeric(tabS7a$category)#
tabS7a$OR2 = substr(tabS7a$OR,1,5)#
#
figS7a = ggplot(tabS7a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.6523322,yend=0.8269309,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.8269309,yend=1.4619838,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=2.2356949,yend=1.0105853,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.0105853,yend=0.8095710,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("A. Cooperators at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.1) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=1.15,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=2.2,label="n.s.",size=6) +#
annotate("text",x=4,y=2.85,label="**",size=10) + #
annotate("text",x=5,y=1.35,label="n.s.",size=6) + #
annotate("text",x=6,y=1.25,label="n.s.",size=6) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
#Data2#
#Fig S7b: Previous defectors #
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Low","High","None","Low","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( 0.1869984  , -0.3880653 ,  -0.215401 , -0.1444834 , -0.223932  ,  -0.9669976  )#
data_se = c(  0.5881108  , 0.3072127  ,  0.2038711  , 0.2682515  ,  0.1529806   ,  0.2377137  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7b$OR = exp(as.numeric(tabS7b$coef)) #
tabS7b$low = exp(as.numeric(tabS7b$coef)-1.96*as.numeric(tabS7b$se)) #
tabS7b$hig = exp(as.numeric(tabS7b$coef)+1.96*as.numeric(tabS7b$se)) #
tabS7b$category = as.numeric(tabS7b$category)#
tabS7b$OR2 = substr(tabS7b$OR,1,5)#
#
figS7b = ggplot(tabS7b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("B. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.1) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=2.3,label="n.s.",size=6) + #
annotate("text",x=2,y=1.15,label="n.s.",size=6) + #
annotate("text",x=3,y=1.15,label="n.s.",size=6) +#
annotate("text",x=4,y=1.25,label="n.s.",size=6) + #
annotate("text",x=5,y=1.15,label="n.s.",size=6) + #
annotate("text",x=6,y=0.55,label="***",size=10) +#
annotate("text",x=2,y=3.1,label="Invisible",size=6) + #
annotate("text",x=5,y=3.1,label="Visible",size=6) #
#
#Fig. S7c-f#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645 , -1.224176 ,2.119447  ,2.01562 , -0.5296941 ,-0.8493965, 1.647417 ,  2.130444 , -1.165752, -1.044851, 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302, 1.024681 ,-0.6777227, -1.563976, 0.9176321 , 1.250339 )#
data_se = c( 0.4379345  ,  0.2510255  , 0.1963933 , 0.1946142  ,  0.3542939   , 0.2161835  , 0.1763198 ,0.1828226 ,  0.2760893  ,0.269753  ,  0.2760372 ,  0.324576  , 0.1292299,0.2921103 , 0.1821481   , 0.3807055, 0.1664283,  0.1803316 , 0.1701283 ,  0.2341324 , 0.1673656  ,  0.302745   ,  0.1970932  ,  0.3751897 ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","Low","Low","High","High",),4))#
#
data_category = c(rep(c(1,1,2,2,3,3),4)) #
data_prev_coop = c(rep(c("C","C","C","C","C","C","D","D","D","D","D","D"),2))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c( 2.497979  , 1.915224   ,  2.119447   ,  2.01562 ,  1.647417  ,  2.130444   , -1.43848   ,-1.206826  ,  -0.8052645   ,  -1.224176  , -0.5296941  ,  -0.8493965  ,  0.7475084 ,  1.579198  , 0.8109302  ,  1.024681  , 0.9176321 ,   1.250339  , -1.165752  , -1.044851  , -1.02351  ,   -1.148623  , -0.6777227  , -1.563976   )#
data_se = c(  0.1963933  , 0.1946142   ,   0.1763198   , 0.1828226  ,   0.2760372    , 0.324576 ,  0.4379345 ,   0.2510255 , 0.3542939   , 0.2161835 ,  0.2760893  , 0.269753 , 0.1821481   ,  0.3807055   ,  0.1701283  ,  0.2341324  ,  0.1970932 ,  0.3751897 , 0.1292299  ,  0.2921103 ,  0.1664283  , 0.1803316  , 0.1673656  , 0.302745  ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( -0.4272013 ,  -0.1900342,   0.3797943 , 0.8045521 ,  0.0105297  , -0.2112508 )#
data_se = c( 0.2388468 ,   0.158823  ,   0.3631553  ,  0.2638676  , 0.1575042  ,  0.3591493  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7a$OR = exp(as.numeric(tabS7a$coef))#
tabS7a$low = exp(as.numeric(tabS7a$coef)-1.96*as.numeric(tabS7a$se)) #
tabS7a$hig = exp(as.numeric(tabS7a$coef)+1.96*as.numeric(tabS7a$se)) #
tabS7a$category = as.numeric(tabS7a$category)#
tabS7a$OR2 = substr(tabS7a$OR,1,5)#
#
figS7a = ggplot(tabS7a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.6523322,yend=0.8269309,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.8269309,yend=1.4619838,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=2.2356949,yend=1.0105853,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.0105853,yend=0.8095710,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("A. Cooperators at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.3) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=1.25,label="n.s.",size=6) + #
annotate("text",x=2,y=1.25,label="n.s.",size=6) + #
annotate("text",x=3,y=3.1,label="n.s.",size=6) +#
annotate("text",x=4,y=3.9,label="**",size=10) + #
annotate("text",x=5,y=1.45,label="n.s.",size=6) + #
annotate("text",x=6,y=1.35,label="n.s.",size=6) +#
annotate("text",x=2,y=3.9,label="Invisible",size=6) + #
annotate("text",x=5,y=3.9,label="Visible",size=6) #
#
#Data2#
#Fig S7b: Previous defectors #
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Low","High","None","Low","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( 0.1869984  , -0.3880653 ,  -0.215401 , -0.1444834 , -0.223932  ,  -0.9669976  )#
data_se = c(  0.5881108  , 0.3072127  ,  0.2038711  , 0.2682515  ,  0.1529806   ,  0.2377137  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7b$OR = exp(as.numeric(tabS7b$coef)) #
tabS7b$low = exp(as.numeric(tabS7b$coef)-1.96*as.numeric(tabS7b$se)) #
tabS7b$hig = exp(as.numeric(tabS7b$coef)+1.96*as.numeric(tabS7b$se)) #
tabS7b$category = as.numeric(tabS7b$category)#
tabS7b$OR2 = substr(tabS7b$OR,1,5)#
#
figS7b = ggplot(tabS7b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("B. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.3) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=3.8,label="n.s.",size=6) + #
annotate("text",x=2,y=1.25,label="n.s.",size=6) + #
annotate("text",x=3,y=1.25,label="n.s.",size=6) +#
annotate("text",x=4,y=1.45,label="n.s.",size=6) + #
annotate("text",x=5,y=1.25,label="n.s.",size=6) + #
annotate("text",x=6,y=0.65,label="***",size=10) +#
annotate("text",x=2,y=3.9,label="Invisible",size=6) + #
annotate("text",x=5,y=3.9,label="Visible",size=6) #
#
#Fig. S7c-f#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645 , -1.224176 ,2.119447  ,2.01562 , -0.5296941 ,-0.8493965, 1.647417 ,  2.130444 , -1.165752, -1.044851, 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302, 1.024681 ,-0.6777227, -1.563976, 0.9176321 , 1.250339 )#
data_se = c( 0.4379345  ,  0.2510255  , 0.1963933 , 0.1946142  ,  0.3542939   , 0.2161835  , 0.1763198 ,0.1828226 ,  0.2760893  ,0.269753  ,  0.2760372 ,  0.324576  , 0.1292299,0.2921103 , 0.1821481   , 0.3807055, 0.1664283,  0.1803316 , 0.1701283 ,  0.2341324 , 0.1673656  ,  0.302745   ,  0.1970932  ,  0.3751897 ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( -0.4272013 ,  -0.1900342,   0.3797943 , 0.8045521 ,  0.0105297  , -0.2112508 )#
data_se = c( 0.2388468 ,   0.158823  ,   0.3631553  ,  0.2638676  , 0.1575042  ,  0.3591493  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7a$OR = exp(as.numeric(tabS7a$coef))#
tabS7a$low = exp(as.numeric(tabS7a$coef)-1.96*as.numeric(tabS7a$se)) #
tabS7a$hig = exp(as.numeric(tabS7a$coef)+1.96*as.numeric(tabS7a$se)) #
tabS7a$category = as.numeric(tabS7a$category)#
tabS7a$OR2 = substr(tabS7a$OR,1,5)#
#
figS7a = ggplot(tabS7a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.6523322,yend=0.8269309,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.8269309,yend=1.4619838,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=2.2356949,yend=1.0105853,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.0105853,yend=0.8095710,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("A. Cooperators at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=1.25,label="n.s.",size=6) + #
annotate("text",x=2,y=1.25,label="n.s.",size=6) + #
annotate("text",x=3,y=3.15,label="n.s.",size=6) +#
annotate("text",x=4,y=3.85,label="**",size=10) + #
annotate("text",x=5,y=1.5,label="n.s.",size=6) + #
annotate("text",x=6,y=1.75,label="n.s.",size=6) +#
annotate("text",x=2,y=4.1,label="Invisible",size=6) + #
annotate("text",x=5,y=4.1,label="Visible",size=6) #
#
#Data2#
#Fig S7b: Previous defectors #
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Low","High","None","Low","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( 0.1869984  , -0.3880653 ,  -0.215401 , -0.1444834 , -0.223932  ,  -0.9669976  )#
data_se = c(  0.5881108  , 0.3072127  ,  0.2038711  , 0.2682515  ,  0.1529806   ,  0.2377137  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7b$OR = exp(as.numeric(tabS7b$coef)) #
tabS7b$low = exp(as.numeric(tabS7b$coef)-1.96*as.numeric(tabS7b$se)) #
tabS7b$hig = exp(as.numeric(tabS7b$coef)+1.96*as.numeric(tabS7b$se)) #
tabS7b$category = as.numeric(tabS7b$category)#
tabS7b$OR2 = substr(tabS7b$OR,1,5)#
#
figS7b = ggplot(tabS7b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("B. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial economic inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=4.0,label="n.s.",size=6) + #
annotate("text",x=2,y=1.45,label="n.s.",size=6) + #
annotate("text",x=3,y=1.35,label="n.s.",size=6) +#
annotate("text",x=4,y=1.55,label="n.s.",size=6) + #
annotate("text",x=5,y=1.25,label="n.s.",size=6) + #
annotate("text",x=6,y=0.65,label="***",size=10) +#
annotate("text",x=2,y=4.1,label="Invisible",size=6) + #
annotate("text",x=5,y=4.1,label="Visible",size=6) #
#
#Fig. S7c-f#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645 , -1.224176 ,2.119447  ,2.01562 , -0.5296941 ,-0.8493965, 1.647417 ,  2.130444 , -1.165752, -1.044851, 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302, 1.024681 ,-0.6777227, -1.563976, 0.9176321 , 1.250339 )#
data_se = c( 0.4379345  ,  0.2510255  , 0.1963933 , 0.1946142  ,  0.3542939   , 0.2161835  , 0.1763198 ,0.1828226 ,  0.2760893  ,0.269753  ,  0.2760372 ,  0.324576  , 0.1292299,0.2921103 , 0.1821481   , 0.3807055, 0.1664283,  0.1803316 , 0.1701283 ,  0.2341324 , 0.1673656  ,  0.302745   ,  0.1970932  ,  0.3751897 ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( -0.4272013 ,  -0.1900342,   0.3797943 , 0.8045521 ,  0.0105297  , -0.2112508 )#
data_se = c( 0.2388468 ,   0.158823  ,   0.3631553  ,  0.2638676  , 0.1575042  ,  0.3591493  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7a = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7a$OR = exp(as.numeric(tabS7a$coef))#
tabS7a$low = exp(as.numeric(tabS7a$coef)-1.96*as.numeric(tabS7a$se)) #
tabS7a$hig = exp(as.numeric(tabS7a$coef)+1.96*as.numeric(tabS7a$se)) #
tabS7a$category = as.numeric(tabS7a$category)#
tabS7a$OR2 = substr(tabS7a$OR,1,5)#
#
figS7a = ggplot(tabS7a,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=0.6523322,yend=0.8269309,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.8269309,yend=1.4619838,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=2.2356949,yend=1.0105853,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=1.0105853,yend=0.8095710,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("A. Cooperators at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=1.25,label="n.s.",size=6) + #
annotate("text",x=2,y=1.3,label="n.s.",size=6) + #
annotate("text",x=3,y=3.15,label="n.s.",size=6) +#
annotate("text",x=4,y=3.85,label="**",size=10) + #
annotate("text",x=5,y=1.55,label="n.s.",size=6) + #
annotate("text",x=6,y=1.8,label="n.s.",size=6) +#
annotate("text",x=2,y=4.1,label="Invisible",size=6) + #
annotate("text",x=5,y=4.1,label="Visible",size=6) #
#
#Data2#
#Fig S7b: Previous defectors #
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Low","High","None","Low","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( 0.1869984  , -0.3880653 ,  -0.215401 , -0.1444834 , -0.223932  ,  -0.9669976  )#
data_se = c(  0.5881108  , 0.3072127  ,  0.2038711  , 0.2682515  ,  0.1529806   ,  0.2377137  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7b$OR = exp(as.numeric(tabS7b$coef)) #
tabS7b$low = exp(as.numeric(tabS7b$coef)-1.96*as.numeric(tabS7b$se)) #
tabS7b$hig = exp(as.numeric(tabS7b$coef)+1.96*as.numeric(tabS7b$se)) #
tabS7b$category = as.numeric(tabS7b$category)#
tabS7b$OR2 = substr(tabS7b$OR,1,5)#
#
figS7b = ggplot(tabS7b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("B. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=4.0,label="n.s.",size=6) + #
annotate("text",x=2,y=1.45,label="n.s.",size=6) + #
annotate("text",x=3,y=1.4,label="n.s.",size=6) +#
annotate("text",x=4,y=1.6,label="n.s.",size=6) + #
annotate("text",x=5,y=1.25,label="n.s.",size=6) + #
annotate("text",x=6,y=0.65,label="***",size=10) +#
annotate("text",x=2,y=4.1,label="Invisible",size=6) + #
annotate("text",x=5,y=4.1,label="Visible",size=6) #
#
#Fig. S7c-f#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645 , -1.224176 ,2.119447  ,2.01562 , -0.5296941 ,-0.8493965, 1.647417 ,  2.130444 , -1.165752, -1.044851, 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302, 1.024681 ,-0.6777227, -1.563976, 0.9176321 , 1.250339 )#
data_se = c( 0.4379345  ,  0.2510255  , 0.1963933 , 0.1946142  ,  0.3542939   , 0.2161835  , 0.1763198 ,0.1828226 ,  0.2760893  ,0.269753  ,  0.2760372 ,  0.324576  , 0.1292299,0.2921103 , 0.1821481   , 0.3807055, 0.1664283,  0.1803316 , 0.1701283 ,  0.2341324 , 0.1673656  ,  0.302745   ,  0.1970932  ,  0.3751897 ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(0,0,0,1,1,1)#
data_gini = c("None","Low","High","None","Low","High")#
data_category2 = c(1,2,3,1,2,3)#
#
data_vis = c("Invisible","Invisible","Invisible","Visible","Visible","Visible")#
data_category = c(1,2,3,1,2,3)#
data_gini = c("0.0","0.2","0.4","0.0","0.2","0.4")#
data_vis_gini = c("Invisible\nNone","Invisible\nLow","Invisible\nHigh","Visible\nNone","Visible\nLow","Visible\nHigh")#
data_beta = c( 0.1869984  , -0.3880653 ,  -0.215401 , -0.1444834 , -0.223932  ,  -0.9669976  )#
data_se = c(  0.5881108  , 0.3072127  ,  0.2038711  , 0.2682515  ,  0.1529806   ,  0.2377137  ) #
data_category2 = c(1,2,3,4,5,6)#
#
tabS7b = data.frame(Visible=data_vis,category=data_category,GINI=data_gini,Vis_GINI=data_vis_gini,coef=data_beta,se=data_se,category2=data_category2)#
#
tabS7b$OR = exp(as.numeric(tabS7b$coef)) #
tabS7b$low = exp(as.numeric(tabS7b$coef)-1.96*as.numeric(tabS7b$se)) #
tabS7b$hig = exp(as.numeric(tabS7b$coef)+1.96*as.numeric(tabS7b$se)) #
tabS7b$category = as.numeric(tabS7b$category)#
tabS7b$OR2 = substr(tabS7b$OR,1,5)#
#
figS7b = ggplot(tabS7b,aes(x=reorder(Vis_GINI,category2),y=OR, color = factor(category))) + #
annotate("segment",x=1,xend=2,y=1.2056254,yend=0.6783680,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=2,xend=3,y=0.6783680,yend=0.8062181,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=4,xend=5,y=0.8654693,yend=0.7993695,color="black",size=0.25,alpha=0.2) +#
annotate("segment",x=5,xend=6,y=0.7993695,yend=0.3802229,color="black",size=0.25,alpha=0.2) +#
geom_point(stat="identity",name=FALSE,size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig),width=0,color=c("skyblue","grey","orange","skyblue","grey","orange")) +#
#geom_hline(yintercept=1,color="grey70",alpha=0.9) +#
ggtitle("B. Defectors at the last move") +#
theme_bw() +#
theme(legend.position=c(0.82,0.725),legend.background=element_rect(fill="white",color="white"),plot.title=element_text(vjust = -2.5,size=17.5),axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
ylim(0,4.5) + #
ylab("Odds Ratios: Effects of being richer than\naverage connecting alters on cooperation\n") + #
xlab("\nInitial inequality") +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_x_discrete(labels=c("None","Low","High","None","Low","High")) + #
annotate("rect",xmin=-Inf,xmax=3.5,ymin=-Inf,ymax=Inf,color="grey90",alpha=0.05) + #
annotate("text",x=1,y=4.0,label="n.s.",size=6) + #
annotate("text",x=2,y=1.45,label="n.s.",size=6) + #
annotate("text",x=3,y=1.4,label="n.s.",size=6) +#
annotate("text",x=4,y=1.65,label="n.s.",size=6) + #
annotate("text",x=5,y=1.3,label="n.s.",size=6) + #
annotate("text",x=6,y=0.65,label="***",size=10) +#
annotate("text",x=2,y=4.1,label="Invisible",size=6) + #
annotate("text",x=5,y=4.1,label="Visible",size=6) #
#
#Fig. S7c-f#
data_vis = c(rep("Invisible",12),rep("Visible",12))#
data_gini = c(rep(c("None","None","None","None","Middle","Middle","Middle","Middle","High","High","High","High"),2))#
#
data_category = c(1:12,1:12) #
data_prev_coop = c(rep(c("D","D","C","C"),6))#
data_richer_a = c(rep(c("Alter is richer","Ego is richer"),12))#
data_category2 = c(rep(c(2,1),12))#
data_beta = c(-1.43848 , -1.206826  , 2.497979 ,  1.915224 ,  -0.8052645 , -1.224176 ,2.119447  ,2.01562 , -0.5296941 ,-0.8493965, 1.647417 ,  2.130444 , -1.165752, -1.044851, 0.7475084 ,1.579198 , -1.02351, -1.148623 , 0.8109302, 1.024681 ,-0.6777227, -1.563976, 0.9176321 , 1.250339 )#
data_se = c( 0.4379345  ,  0.2510255  , 0.1963933 , 0.1946142  ,  0.3542939   , 0.2161835  , 0.1763198 ,0.1828226 ,  0.2760893  ,0.269753  ,  0.2760372 ,  0.324576  , 0.1292299,0.2921103 , 0.1821481   , 0.3807055, 0.1664283,  0.1803316 , 0.1701283 ,  0.2341324 , 0.1673656  ,  0.302745   ,  0.1970932  ,  0.3751897 ) #
#
tabS7 = data.frame(Visible=data_vis,GINI=data_gini,category=data_category,prev_coop=data_prev_coop,richer_a=data_richer_a,category2=data_category2,coef=data_beta,se=data_se)#
#
tabS7$Prob = inv.logit(as.numeric(tabS7$coef)) #
tabS7$low = inv.logit(as.numeric(tabS7$coef)-1*as.numeric(tabS7$se)) #
tabS7$hig = inv.logit(as.numeric(tabS7$coef)+1*as.numeric(tabS7$se)) #
tabS7$category = as.numeric(tabS7$category)#
tabS7$category2 = as.numeric(tabS7$category2)#
tabS7$Prob2 = substr(tabS7$Prob,1,5)#
#
tabS7c = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "C",]#
tabS7d = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "C",]#
tabS7e = tabS7[tabS7$Visible == "Invisible" & tabS7$prev_coop == "D",]#
tabS7f = tabS7[tabS7$Visible == "Visible" & tabS7$prev_coop == "D",]#
#
figS7c = ggplot(tabS7c,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("C. Cooperators at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7d = ggplot(tabS7e,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + #
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("D. Defectors at the last move\n(Invisible setting)") + theme(plot.title=element_text(vjust = -4.5),panel.border=element_blank(),panel.background=element_rect(fill="grey85")) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7e = ggplot(tabS7d,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.165)) + theme(legend.key=element_blank()) +#
ggtitle("E. Cooperators at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
figS7f = ggplot(tabS7f,aes(x=reorder(GINI,category),y=Prob, group=category, fill= reorder(richer_a,category2))) + #
geom_bar(stat="identity",position="dodge") + ylim(0,1) + theme_bw() +#
theme(axis.text.x = element_text(angle=0, size=11),axis.ticks = element_blank(),panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border=element_blank(),panel.grid.minor = element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3)) +#
scale_fill_manual(values=c("deepskyblue","orange"),name="Wealth comparison") + #
ylab("Cooperation rate") + #
xlab("Initial inequality") +#
theme(legend.position=c(0.775,0.75)) + theme(legend.key=element_blank()) +#
ggtitle("F. Defectors at the last move\n(Visible setting)") + theme(plot.title=element_text(vjust = -4.5)) + #
geom_text(aes(label=Prob2),vjust=1.5,color="white",position=position_dodge(0.9),size=5) +#
geom_errorbar(aes(ymin=low,ymax=hig,color=Visible),position=position_dodge(0.9),width=0,alpha=0.75, color="black") #
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS7_1028.png", width=3500, height=5250, res=350) #
multiplot(figS7a,figS7c,figS7e,figS7b,figS7d,figS7f,cols=2, layout=NULL)#
dev.off()
library(reldist)#
library(Zelig)#
library(ggplot2)#
library(grid)#
#
#Step 2: Multiple plots at ggplot2 #
	multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {#
	  require(grid)#
#
	  # Make a list from the ... arguments and plotlist#
	  plots <- c(list(...), plotlist)#
#
	  numPlots = length(plots)#
#
	  # If layout is NULL, then use 'cols' to determine layout#
	  if (is.null(layout)) {#
	    # Make the panel#
	    # ncol: Number of columns of plots#
	    # nrow: Number of rows needed, calculated from # of cols#
	    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),#
	                    ncol = cols, nrow = ceiling(numPlots/cols))#
	  }#
#
	 if (numPlots==1) {#
	    print(plots[[1]])#
#
	  } else {#
	    # Set up the page#
	    grid.newpage()#
	    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))#
#
	    # Make each plot, in the correct location#
	    for (i in 1:numPlots) {#
	      # Get the i,j matrix positions of the regions that contain this subplot#
	      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))#
#
	      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,#
	                                      layout.pos.col = matchidx$col))#
	    }#
	  }#
	}#
#
#DATA1: Average-session-level data (n=88)#
ndata8 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata8_0527.csv",stringsAsFactors=FALSE)#
ndata8$gini_n = as.numeric(ndata8$GINI == "Low") + 2*as.numeric(ndata8$GINI == "High")#
ndata8$GINIn = as.factor(0.2*as.numeric(ndata8$GINI == "Low") + 0.4*as.numeric(ndata8$GINI == "High"))#
ndata8$GINIn2 = as.numeric(0.2*as.numeric(ndata8$GINI == "Low") + 0.4*as.numeric(ndata8$GINI == "High"))#
ndata8$Visible = ifelse(ndata8$Visible == "2.Invisible", "Invisible","Visible") #
#
#DATA1b: Average-session-level data (n=110)#
n2data8 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/n2data8_0527.csv",stringsAsFactors=FALSE)#
n2data8$gini_n = as.numeric(n2data8$GINI == "Low_Poor") + 2*as.numeric(n2data8$GINI == "Low_Rich") + 3*as.numeric(n2data8$GINI == "High_Poor") + 4*as.numeric(n2data8$GINI == "High_Rich")#
#
#DATA2: Session-level data (n=880)#
ndata4 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/ndata4_0513.csv",header=TRUE,stringsAsFactor=FALSE) #
ndata4$all = paste0(ndata4$scoreA,"_",ndata4$scoreB,"_",100*ndata4$percentA)#
ndata4$GINI = NA#
ndata4[ndata4$all == "1150_200_30", "GINI"] = "High"#
ndata4[ndata4$all == "850_350_30", "GINI"] = "Low"#
ndata4[ndata4$all == "500_500_50", "GINI"] = "None"#
ndata4[ndata4$all == "700_300_50", "GINI"] = "Low"#
ndata4$Visible = ifelse(ndata4$showScore == "false", "Invisible","Visible") #
#
ndata4_2 = ndata4[ndata4$round == 10,]#
colnames(ndata4_2)[9:15] = paste0("r10_",colnames(ndata4_2)[9:15])#
#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "None","gini_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "Low","gini_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "High","gini_all"])#
#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "None","gmd_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "Low","gmd_all"])#
summary(ndata4[ndata4$round==0 & ndata4$GINI == "High","gmd_all"])#
#
summary(ndata4$n_par)#
summary(ndata4$behavior_all)#
summary(ndata4$degree_all)#
summary(ndata4$cumulativePayoff_all)#
summary(ndata4$gmd_all)#
summary(ndata4$gini_all)#
#
#DATA3: Lag coopeation data#
mdata3 = read.csv("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/DATA/mdata3_0513.csv",stringsAsFactors=FALSE) #all (50,700)#
mdata3$a_m_e_wealth = mdata3$local_avg_wealth - mdata3$e_cumulativePayoff#
mdata3$condition = NA #
mdata3[mdata3$scoreA == 500 & mdata3$showScore == "true",]$condition = "Visible, None"#
mdata3[mdata3$scoreA %in% c(700,850) & mdata3$showScore == "true",]$condition = "Visible, Low"#
mdata3[mdata3$scoreA == 1150 & mdata3$showScore == "true",]$condition = "Visible, High"#
mdata3[mdata3$scoreA == 500 & mdata3$showScore == "false",]$condition = "Invisible, None"#
mdata3[mdata3$scoreA %in% c(700,850) & mdata3$showScore == "false",]$condition = "Invisible, Low"#
mdata3[mdata3$scoreA == 1150 & mdata3$showScore == "false",]$condition = "Invisible, High"#
#
summary(mdata3[mdata3$round==10,"cumulativePayoff"])#
#
#ABM Data import#
load("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/ABM/ABM_result_0617a.RData") #
ABM_result$round_j = NA#
ABM_result[ABM_result$GINI == 0,"round_j"] = ABM_result[ABM_result$GINI == 0,"round"] - 0.05#
ABM_result[ABM_result$GINI == 0.2,"round_j"] = ABM_result[ABM_result$GINI == 0.2,"round"] + 0.0#
ABM_result[ABM_result$GINI == 0.4,"round_j"] = ABM_result[ABM_result$GINI == 0.4,"round"] + 0.05#
ABM_result$GINI = as.factor(ABM_result$GINI)#
#
ABM_result_normal = ABM_result[ABM_result$Category=="All",]#
ABM_result_strat = ABM_result[(ABM_result$Category=="All" & ABM_result$GINI==0) | (ABM_result$Category %in% c("rich","poor") & ABM_result$GINI %in% c(0.2,0.4)),]#
#
ABM_result_strat$Category2 = NA#
ABM_result_strat[ABM_result_strat$GINI==0 & ABM_result_strat$Category=="All",]$Category2 = "None"#
ABM_result_strat[ABM_result_strat$GINI==0.2 & ABM_result_strat$Category=="rich",]$Category2 = "Low_Rich"#
ABM_result_strat[ABM_result_strat$GINI==0.2 & ABM_result_strat$Category=="poor",]$Category2 = "Low_Poor"#
ABM_result_strat[ABM_result_strat$GINI==0.4 & ABM_result_strat$Category=="rich",]$Category2 = "High_Rich"#
ABM_result_strat[ABM_result_strat$GINI==0.4 & ABM_result_strat$Category=="poor",]$Category2 = "High_Poor"#
ABM_result_strat$gini_n = as.numeric(ABM_result_strat$Category2 == "Low_Poor") + 2*as.numeric(ABM_result_strat$Category2 == "Low_Rich") + 3*as.numeric(ABM_result_strat$Category2 == "High_Poor") + 4*as.numeric(ABM_result_strat$Category2 == "High_Rich")
figS9a = ggplot(ABM_result_normal, aes(x=round_j,y=gini_avg,linetype=Visibility,color=GINI)) + ylim(-0.01,0.6) + geom_line() + theme_bw() +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_linetype_manual(values=c("solid","dashed"),guide=FALSE) + #
ylab("GINI") + xlab("Round") + #
theme(legend.position=c(0.75,0.29),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5),axis.text = element_text(angle=0, size=15),axis.ticks = element_blank(),panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.title=element_text(size=15)) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="A",size=10) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
#figS9b: Mean difference for 80 sessions.#
figS9b = ggplot(ABM_result_normal, aes(x=round_j,y=gmd_avg,linetype=Visibility,color=GINI)) + ylim(-0.01,1750) + geom_line() + theme_bw() +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_linetype_manual(values=c("solid","dashed"),guide=FALSE) + #
ylab("Mean difference") + xlab("Round") + #
theme(legend.position=c(0.75,0.29),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5),axis.text = element_text(angle=0, size=15),axis.ticks = element_blank(),panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.title=element_text(size=15)) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="B",size=10) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#figS9c: Average score#
figS9c = ggplot(ABM_result_normal, aes(x=round_j,y=wealth_avg,linetype=Visibility,color=GINI)) + ylim(0,6000) + geom_line() + theme_bw() +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_linetype_manual(values=c("solid","dashed"),guide=FALSE) + #
ylab("Average wealth") + xlab("Round") + #
theme(legend.position=c(0.75,0.29),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5),axis.text = element_text(angle=0, size=15),axis.ticks = element_blank(),panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.title=element_text(size=15)) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="C",size=10) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
#figS9d: cooperation rate#
ABM_result_normal2 = ABM_result_normal[ABM_result_normal$round>=1,]#
ABM_result_normal2$coop_05 = as.numeric(ABM_result_normal2$coop_05)#
ABM_result_normal2$coop_95 = as.numeric(ABM_result_normal2$coop_95)#
figS9d = ggplot(ABM_result_normal2, aes(x=round_j,y=coop_avg,linetype=Visibility,color=GINI)) + ylim(-0.1,1) + geom_line() + theme_bw() +#
scale_color_manual(values=c("skyblue","grey","orange"),guide=FALSE) + #
scale_linetype_manual(values=c("solid","dashed"),guide=FALSE) + #
ylab("Proportion of cooepration") + xlab("Round") + #
theme(legend.position=c(0.75,0.29),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5),axis.text = element_text(angle=0, size=15),axis.ticks = element_blank(),panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.title=element_text(size=15)) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="D",size=10) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
#figS9d: Degree#
figS9e = ggplot(ABM_result_normal, aes(x=round_j,y=degree_avg,linetype=Visibility,color=GINI)) + ylim(0,12) + geom_line() + theme_bw() +#
scale_color_manual(values=c("skyblue","grey","orange"),labels=c("None","Low","High"),name="Initial inequality") + #
scale_linetype_manual(values=c("solid","dashed"),name="Neighbors' wealth\ninformation") + #
ylab("Degree") + xlab("Round") + #
theme(legend.position=c(0.75,0.29),legend.background=element_blank(),legend.key=element_blank(),plot.title=element_text(vjust = -2.5),axis.text = element_text(angle=0, size=15),axis.ticks = element_blank(),panel.grid.minor = element_blank(),panel.border=element_blank(),panel.background=element_blank(),axis.line = element_line(color = 'black',size=0.3),axis.title=element_text(size=15)) +#
annotate("text",x=-Inf,y=Inf,vjust=1,hjust=-0.9,label="E",size=10) +#
scale_x_continuous(breaks = seq(0, 10, 2))#
#
png("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Analysis/EXH/FigS9_1028.png", width=6000, height=4000, res=400) #
multiplot(figS9a,figS9d,figS9b,figS9e,figS9c,cols=3, layout=NULL)#
dev.off()
library(rjson)#
#
#Step 1: Original data#
#setwd("/XXXXX/Nishi_Shirado_GINI") #Please specify your directory#
setwd("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Nishi_Shirado_GINI") #
data_list = c("D2013-11-07-01_4227.json","D2013-11-07-02_4257.json", "D2013-11-07-03_4261.json","D2013-11-07-04_4289.json",#
"D2013-11-08-03_4353.json","D2013-11-08-04_4354.json","D2013-11-11-01_4361.json","D2013-11-11-02_4385.json","D2013-11-11-03_4417.json",#
"D2013-11-11-04_4421.json","D2013-11-12-01_4449.json","D2013-11-12-02_4461.json","D2013-11-14-01-4546.json","D2013-11-15-01_4547.json",#
"D2013-11-16-01_4577.json","D2013-11-16-02_4578.json","D2013-11-18-01_4581.json",#
"D2013-11-18-02_4609.json","D2013-11-18-03_4621.json","D2013-11-18-04_4641.json","D2013-11-18-05_4673.json",#
"D2013-11-18-06_4681.json","D2013-11-19-01_4705.json","D2013-11-19-02_4737.json","D2013-11-19-03_4741.json",#
"D2013-11-19-04_4769.json","D2013-11-19-05_4781.json","D2013-11-20-01_4801.json","D2013-11-20-02_4833.json",#
"D2013-11-20-03_4841.json","D2013-11-21-01_4866.json","D2013-11-21-02_4897.json","D2013-11-21-03_4901.json",#
"D2013-11-21-04_4929.json","D2013-11-21-05_4941.json","D2013-11-21-07_4993.json","D2013-11-22-01_5001.json",#
"D2013-11-22-02_5002.json","D2013-11-22-03_5003.json","D2013-11-26-04_5061.json","D2013-12-02-02_5153.json",#
"D2013-12-02-03_5161.json","D2013-12-02-04_5163.json","D2013-12-02-05_5164.json","D2013-12-02-06_5185.json",#
"D2013-12-05-01_5313.json","D2013-12-05-02_5321.json","D2013-12-06-01_5377.json","D2013-12-06-04_5441.json",#
"D2013-12-09-01_5473.json","D2013-12-09-02_5481.json","D2013-12-09-03_5505.json","D2013-12-09-04_5537.json",#
"D2013-12-09-05_5541.json","D2013-12-10-01_5569.json","D2013-12-10-02_5581.json","D2013-12-10-04_5633.json",#
"D2013-12-10-05_5641.json","D2013-12-10-06_5665.json","D2013-12-11-01_5697.json","D2013-12-11-02_5701.json",#
"D2013-12-11-03_5729.json","D2013-12-11-04_5741.json","D2013-12-11-05_5761.json","D2013-12-11-06_5793.json",#
"D2013-12-12-01_5801.json","D2013-12-12-03_5861.json","D2013-12-13-01_5889.json","D2013-12-13-02_5901.json",#
"D2013-12-13-03_5921.json","D2013-12-16-01_5953.json","D2013-12-16-02_5961.json","D2013-12-16-03_5985.json",#
"D2013-12-17-01_6061.json","D2013-12-17-02_6081.json","D2013-12-17-03_6113.json","D2013-12-18-01_6221.json",#
"D2013-12-18-02_6241.json","D2013-12-18-03_6273.json","D2013-12-19-03_6337.json")#
#
for (i in 1:80)#
{#
data1 = fromJSON(file=data_list[i], method="C", unexpected.escape="error") #
#
#The detail of the data format, see Hirokazu Shirado's json_format.rtf #
#Note: each graph data is the result AFTER cooperation and rewiring step. Therefore, if you want to know connections when players select cooperation or defection, you have to use the graph data of the PRECEDING round.#
#T500_1 is a list#
#Starting: gameId, scoreA, scoreB, profit, initDensity, percentA, showScore, cost#
#In $result: `0` to `10`#
#In each number: directed(always FALSE), graph (round number), nodes, links, multigraph(always FALSE)#
#In nodes of `0`: nodes[[i]]$id, initScore (i = 1-25)#
#In nodes of `1`-: nodes[[i]]$id, initScore, payoff, cumulativePayoff, behavior, behaviorTime, makeLink, notMakeLink, breakLink, notbreakLink #
#In links of `0`,`1`-: link[[j]]$id#
#
#1. Nodes data#
data2_r0 = as.data.frame(do.call("rbind", data1$result$`0`$nodes))#
data2_r1 = as.data.frame(do.call("rbind", data1$result$`1`$nodes))#
data2_r2 = as.data.frame(do.call("rbind", data1$result$`2`$nodes))#
data2_r3 = as.data.frame(do.call("rbind", data1$result$`3`$nodes))#
data2_r4 = as.data.frame(do.call("rbind", data1$result$`4`$nodes))#
data2_r5 = as.data.frame(do.call("rbind", data1$result$`5`$nodes))#
data2_r6 = as.data.frame(do.call("rbind", data1$result$`6`$nodes))#
data2_r7 = as.data.frame(do.call("rbind", data1$result$`7`$nodes))#
data2_r8 = as.data.frame(do.call("rbind", data1$result$`8`$nodes))#
data2_r9 = as.data.frame(do.call("rbind", data1$result$`9`$nodes))#
data2_r10 = as.data.frame(do.call("rbind", data1$result$`10`$nodes))#
data2_r0$cumulativePayoff = data2_r0$behaviorTime = data2_r0$notMakeLink = data2_r0$notBreakLink = data2_r0$behavior = data2_r0$breakLink = data2_r0$makeLink = data2_r0$payoff = NA  #
data2_r0 = data2_r0[,names(data2_r1)]#
data2_r0$round = 0#
data2_r1$round = 1#
data2_r2$round = 2#
data2_r3$round = 3#
data2_r4$round = 4#
data2_r5$round = 5#
data2_r6$round = 6#
data2_r7$round = 7#
data2_r8$round = 8#
data2_r9$round = 9#
data2_r10$round = 10#
data2 = rbind(data2_r0,data2_r1,data2_r2,data2_r3,data2_r4,data2_r5,data2_r6,data2_r7,data2_r8,data2_r9,data2_r10)#
data2$gameID = data1$gameId#
data2$scoreA = data1$scoreA#
data2$scoreB = data1$scoreB#
data2$percentA = data1$percentA#
data2$showScore = data1$showScore#
#
data2$initScore = unlist(data2$initScore)#
data2$cumulativePayoff = unlist(data2$cumulativePayoff)#
data2$behaviorTime = unlist(data2$behaviorTime)#
data2$behavior = unlist(data2$behavior)#
data2$id = unlist(data2$id)#
data2$payoff = unlist(data2$payoff)#
#
#2. Links data#
data3_r0 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`0`$links))$id),ncol=2,byrow=TRUE))#
data3_r1 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`1`$links))$id),ncol=2,byrow=TRUE))#
data3_r2 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`2`$links))$id),ncol=2,byrow=TRUE))#
data3_r3 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`3`$links))$id),ncol=2,byrow=TRUE))#
data3_r4 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`4`$links))$id),ncol=2,byrow=TRUE))#
data3_r5 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`5`$links))$id),ncol=2,byrow=TRUE))#
data3_r6 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`6`$links))$id),ncol=2,byrow=TRUE))#
data3_r7 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`7`$links))$id),ncol=2,byrow=TRUE))#
data3_r8 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`8`$links))$id),ncol=2,byrow=TRUE))#
data3_r9 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`9`$links))$id),ncol=2,byrow=TRUE))#
data3_r10 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`10`$links))$id),ncol=2,byrow=TRUE))#
data3_r0$round = 0#
data3_r1$round = 1#
data3_r2$round = 2#
data3_r3$round = 3#
data3_r4$round = 4#
data3_r5$round = 5#
data3_r6$round = 6#
data3_r7$round = 7#
data3_r8$round = 8#
data3_r9$round = 9#
data3_r10$round = 10#
data3 = rbind(data3_r0,data3_r1,data3_r2,data3_r3,data3_r4,data3_r5,data3_r6,data3_r7,data3_r8,data3_r9,data3_r10)#
colnames(data3) = c("id1","id2","round")#
data3$gameID = data1$gameId#
data3$scoreA = data1$scoreA#
data3$scoreB = data1$scoreB#
data3$percentA = data1$percentA#
data3$showScore = data1$showScore#
#
if (i ==1)#
	{#
	data2_combined = data2#
	data3_combined = data3#
	}#
else#
	{#
	data2_combined = rbind(data2_combined,data2)#
	data3_combined = rbind(data3_combined,data3)#
	}#
print(i)#
}#
#
#save as R object #
ndata = data2_combined #node data#
ldata = data3_combined #link data#
#
#REPEAT: ndata and ldata#
ldata$game = NA #
ldata[ldata$gameID=="D2013-11-07-01_4227","game"] = 1#
ldata[ldata$gameID=="D2013-11-07-02_4257","game"] = 2#
ldata[ldata$gameID=="D2013-11-07-03_4261","game"] = 3#
ldata[ldata$gameID=="D2013-11-07-04_4289","game"] = 4#
ldata[ldata$gameID=="D2013-11-08-03_4353","game"] = 5#
ldata[ldata$gameID=="D2013-11-08-04_4354","game"] = 6#
ldata[ldata$gameID=="D2013-11-11-01_4361","game"] = 7#
ldata[ldata$gameID=="D2013-11-11-02_4385","game"] = 8#
ldata[ldata$gameID=="D2013-11-11-03_4417","game"] = 9#
ldata[ldata$gameID=="D2013-11-11-04_4421","game"] = 10#
ldata[ldata$gameID=="D2013-11-12-01_4449","game"] = 11#
ldata[ldata$gameID=="D2013-11-12-02_4461","game"] = 12 #
ldata[ldata$gameID=="D2013-11-14-01-4546","game"] = 13#
ldata[ldata$gameID=="D2013-11-15-01_4547","game"] = 14#
ldata[ldata$gameID=="D2013-11-16-01_4577","game"] = 15#
ldata[ldata$gameID=="D2013-11-16-02_4578","game"] = 16#
ldata[ldata$gameID=="D2013-11-18-01_4581","game"] = 17#
ldata[ldata$gameID=="D2013-11-18-02_4609","game"] = 18#
ldata[ldata$gameID=="D2013-11-18-03_4621","game"] = 19#
ldata[ldata$gameID=="D2013-11-18-04_4641","game"] = 20#
ldata[ldata$gameID=="D2013-11-18-05_4673","game"] = 21#
ldata[ldata$gameID=="D2013-11-18-06_4681","game"] = 22#
ldata[ldata$gameID=="D2013-11-19-01_4705","game"] = 23#
ldata[ldata$gameID=="D2013-11-19-02_4737","game"] = 24#
ldata[ldata$gameID=="D2013-11-19-03_4741","game"] = 25#
ldata[ldata$gameID=="D2013-11-19-04_4769","game"] = 26#
ldata[ldata$gameID=="D2013-11-19-05_4781","game"] = 27#
ldata[ldata$gameID=="D2013-11-20-01_4801","game"] = 28#
ldata[ldata$gameID=="D2013-11-20-02_4833","game"] = 29#
ldata[ldata$gameID=="D2013-11-20-03_4841","game"] = 30#
ldata[ldata$gameID=="D2013-11-21-01_4866","game"] = 31#
ldata[ldata$gameID=="D2013-11-21-02_4897","game"] = 32#
ldata[ldata$gameID=="D2013-11-21-03_4901","game"] = 33#
ldata[ldata$gameID=="D2013-11-21-04_4929","game"] = 34#
ldata[ldata$gameID=="D2013-11-21-05_4941","game"] = 35#
ldata[ldata$gameID=="D2013-11-21-07_4993","game"] = 36#
ldata[ldata$gameID=="D2013-11-22-01_5001","game"] = 37#
ldata[ldata$gameID=="D2013-11-22-02_5002","game"] = 38#
ldata[ldata$gameID=="D2013-11-22-03_5003","game"] = 39#
ldata[ldata$gameID=="D2013-11-26-04_5061","game"] = 40#
ldata[ldata$gameID=="D2013-12-02-02_5153","game"] = 41#
ldata[ldata$gameID=="D2013-12-02-03_5161","game"] = 42#
ldata[ldata$gameID=="D2013-12-02-04_5163","game"] = 43#
ldata[ldata$gameID=="D2013-12-02-05_5164","game"] = 44#
ldata[ldata$gameID=="D2013-12-02-06_5185","game"] = 45#
ldata[ldata$gameID=="D2013-12-05-01_5313","game"] = 46#
ldata[ldata$gameID=="D2013-12-05-02_5321","game"] = 47#
ldata[ldata$gameID=="D2013-12-06-01_5377","game"] = 48#
ldata[ldata$gameID=="D2013-12-06-04_5441","game"] = 49#
ldata[ldata$gameID=="D2013-12-09-01_5473","game"] = 50#
ldata[ldata$gameID=="D2013-12-09-02_5481","game"] = 51#
ldata[ldata$gameID=="D2013-12-09-03_5505","game"] = 52#
ldata[ldata$gameID=="D2013-12-09-04_5537","game"] = 53#
ldata[ldata$gameID=="D2013-12-09-05_5541","game"] = 54#
ldata[ldata$gameID=="D2013-12-10-01_5569","game"] = 55#
ldata[ldata$gameID=="D2013-12-10-02_5581","game"] = 56#
ldata[ldata$gameID=="D2013-12-10-04_5633","game"] = 57#
ldata[ldata$gameID=="D2013-12-10-05_5641","game"] = 58#
ldata[ldata$gameID=="D2013-12-10-06_5665","game"] = 59#
ldata[ldata$gameID=="D2013-12-11-01_5697","game"] = 60#
ldata[ldata$gameID=="D2013-12-11-02_5701","game"] = 61#
ldata[ldata$gameID=="D2013-12-11-03_5729","game"] = 62#
ldata[ldata$gameID=="D2013-12-11-04_5741","game"] = 63#
ldata[ldata$gameID=="D2013-12-11-05_5761","game"] = 64#
ldata[ldata$gameID=="D2013-12-11-06_5793","game"] = 65#
ldata[ldata$gameID=="D2013-12-12-01_5801","game"] = 66#
ldata[ldata$gameID=="D2013-12-12-03_5861","game"] = 67#
ldata[ldata$gameID=="D2013-12-13-01_5889","game"] = 68#
ldata[ldata$gameID=="D2013-12-13-02_5901","game"] = 69#
ldata[ldata$gameID=="D2013-12-13-03_5921","game"] = 70#
ldata[ldata$gameID=="D2013-12-16-01_5953","game"] = 71#
ldata[ldata$gameID=="D2013-12-16-02_5961","game"] = 72#
ldata[ldata$gameID=="D2013-12-16-03_5985","game"] = 73#
ldata[ldata$gameID=="D2013-12-17-01_6061","game"] = 74#
ldata[ldata$gameID=="D2013-12-17-02_6081","game"] = 75#
ldata[ldata$gameID=="D2013-12-17-03_6113","game"] = 76#
ldata[ldata$gameID=="D2013-12-18-01_6221","game"] = 77#
ldata[ldata$gameID=="D2013-12-18-02_6241","game"] = 78#
ldata[ldata$gameID=="D2013-12-18-03_6273","game"] = 79#
ldata[ldata$gameID=="D2013-12-19-03_6337","game"] = 80#
ldata$costbenefit = ifelse(ldata$game %in% 1:80, 50100, 1020)#
#REPEAT DONE #
#
ndata$game = NA #
ndata[ndata$gameID=="D2013-11-07-01_4227","game"] = 1#
ndata[ndata$gameID=="D2013-11-07-02_4257","game"] = 2#
ndata[ndata$gameID=="D2013-11-07-03_4261","game"] = 3#
ndata[ndata$gameID=="D2013-11-07-04_4289","game"] = 4#
ndata[ndata$gameID=="D2013-11-08-03_4353","game"] = 5#
ndata[ndata$gameID=="D2013-11-08-04_4354","game"] = 6#
ndata[ndata$gameID=="D2013-11-11-01_4361","game"] = 7#
ndata[ndata$gameID=="D2013-11-11-02_4385","game"] = 8#
ndata[ndata$gameID=="D2013-11-11-03_4417","game"] = 9#
ndata[ndata$gameID=="D2013-11-11-04_4421","game"] = 10#
ndata[ndata$gameID=="D2013-11-12-01_4449","game"] = 11#
ndata[ndata$gameID=="D2013-11-12-02_4461","game"] = 12 #
ndata[ndata$gameID=="D2013-11-14-01-4546","game"] = 13#
ndata[ndata$gameID=="D2013-11-15-01_4547","game"] = 14#
ndata[ndata$gameID=="D2013-11-16-01_4577","game"] = 15#
ndata[ndata$gameID=="D2013-11-16-02_4578","game"] = 16#
ndata[ndata$gameID=="D2013-11-18-01_4581","game"] = 17#
ndata[ndata$gameID=="D2013-11-18-02_4609","game"] = 18#
ndata[ndata$gameID=="D2013-11-18-03_4621","game"] = 19#
ndata[ndata$gameID=="D2013-11-18-04_4641","game"] = 20#
ndata[ndata$gameID=="D2013-11-18-05_4673","game"] = 21#
ndata[ndata$gameID=="D2013-11-18-06_4681","game"] = 22#
ndata[ndata$gameID=="D2013-11-19-01_4705","game"] = 23#
ndata[ndata$gameID=="D2013-11-19-02_4737","game"] = 24#
ndata[ndata$gameID=="D2013-11-19-03_4741","game"] = 25#
ndata[ndata$gameID=="D2013-11-19-04_4769","game"] = 26#
ndata[ndata$gameID=="D2013-11-19-05_4781","game"] = 27#
ndata[ndata$gameID=="D2013-11-20-01_4801","game"] = 28#
ndata[ndata$gameID=="D2013-11-20-02_4833","game"] = 29#
ndata[ndata$gameID=="D2013-11-20-03_4841","game"] = 30#
ndata[ndata$gameID=="D2013-11-21-01_4866","game"] = 31#
ndata[ndata$gameID=="D2013-11-21-02_4897","game"] = 32#
ndata[ndata$gameID=="D2013-11-21-03_4901","game"] = 33#
ndata[ndata$gameID=="D2013-11-21-04_4929","game"] = 34#
ndata[ndata$gameID=="D2013-11-21-05_4941","game"] = 35#
ndata[ndata$gameID=="D2013-11-21-07_4993","game"] = 36#
ndata[ndata$gameID=="D2013-11-22-01_5001","game"] = 37#
ndata[ndata$gameID=="D2013-11-22-02_5002","game"] = 38#
ndata[ndata$gameID=="D2013-11-22-03_5003","game"] = 39#
ndata[ndata$gameID=="D2013-11-26-04_5061","game"] = 40#
ndata[ndata$gameID=="D2013-12-02-02_5153","game"] = 41#
ndata[ndata$gameID=="D2013-12-02-03_5161","game"] = 42#
ndata[ndata$gameID=="D2013-12-02-04_5163","game"] = 43#
ndata[ndata$gameID=="D2013-12-02-05_5164","game"] = 44#
ndata[ndata$gameID=="D2013-12-02-06_5185","game"] = 45#
ndata[ndata$gameID=="D2013-12-05-01_5313","game"] = 46#
ndata[ndata$gameID=="D2013-12-05-02_5321","game"] = 47#
ndata[ndata$gameID=="D2013-12-06-01_5377","game"] = 48#
ndata[ndata$gameID=="D2013-12-06-04_5441","game"] = 49#
ndata[ndata$gameID=="D2013-12-09-01_5473","game"] = 50#
ndata[ndata$gameID=="D2013-12-09-02_5481","game"] = 51#
ndata[ndata$gameID=="D2013-12-09-03_5505","game"] = 52#
ndata[ndata$gameID=="D2013-12-09-04_5537","game"] = 53#
ndata[ndata$gameID=="D2013-12-09-05_5541","game"] = 54#
ndata[ndata$gameID=="D2013-12-10-01_5569","game"] = 55#
ndata[ndata$gameID=="D2013-12-10-02_5581","game"] = 56#
ndata[ndata$gameID=="D2013-12-10-04_5633","game"] = 57#
ndata[ndata$gameID=="D2013-12-10-05_5641","game"] = 58#
ndata[ndata$gameID=="D2013-12-10-06_5665","game"] = 59#
ndata[ndata$gameID=="D2013-12-11-01_5697","game"] = 60#
ndata[ndata$gameID=="D2013-12-11-02_5701","game"] = 61#
ndata[ndata$gameID=="D2013-12-11-03_5729","game"] = 62#
ndata[ndata$gameID=="D2013-12-11-04_5741","game"] = 63#
ndata[ndata$gameID=="D2013-12-11-05_5761","game"] = 64#
ndata[ndata$gameID=="D2013-12-11-06_5793","game"] = 65#
ndata[ndata$gameID=="D2013-12-12-01_5801","game"] = 66#
ndata[ndata$gameID=="D2013-12-12-03_5861","game"] = 67#
ndata[ndata$gameID=="D2013-12-13-01_5889","game"] = 68#
ndata[ndata$gameID=="D2013-12-13-02_5901","game"] = 69#
ndata[ndata$gameID=="D2013-12-13-03_5921","game"] = 70#
ndata[ndata$gameID=="D2013-12-16-01_5953","game"] = 71#
ndata[ndata$gameID=="D2013-12-16-02_5961","game"] = 72#
ndata[ndata$gameID=="D2013-12-16-03_5985","game"] = 73#
ndata[ndata$gameID=="D2013-12-17-01_6061","game"] = 74#
ndata[ndata$gameID=="D2013-12-17-02_6081","game"] = 75#
ndata[ndata$gameID=="D2013-12-17-03_6113","game"] = 76#
ndata[ndata$gameID=="D2013-12-18-01_6221","game"] = 77#
ndata[ndata$gameID=="D2013-12-18-02_6241","game"] = 78#
ndata[ndata$gameID=="D2013-12-18-03_6273","game"] = 79#
ndata[ndata$gameID=="D2013-12-19-03_6337","game"] = 80#
ndata$costbenefit = ifelse(ndata$game %in% 1:80, 50100, 1020)#
#
dim(ndata) #15258 individual-rounds with 18 variables (see the codebook)#
dim(ldata) #63309 tie-rounds with 10 variables (see the codebook)
library(rjson)#
#
#Step 1: Original data#
#setwd("/XXXXX/Nishi_Shirado_GINI") #Please specify your directory#
setwd("/Users/akihironishi/Dropbox/ArticlesAN/ANHS13GINI/Archive/Nishi_Shirado_GINI") #
data_list = c("D2013-11-07-01_4227.json","D2013-11-07-02_4257.json", "D2013-11-07-03_4261.json","D2013-11-07-04_4289.json",#
"D2013-11-08-03_4353.json","D2013-11-08-04_4354.json","D2013-11-11-01_4361.json","D2013-11-11-02_4385.json","D2013-11-11-03_4417.json",#
"D2013-11-11-04_4421.json","D2013-11-12-01_4449.json","D2013-11-12-02_4461.json","D2013-11-14-01-4546.json","D2013-11-15-01_4547.json",#
"D2013-11-16-01_4577.json","D2013-11-16-02_4578.json","D2013-11-18-01_4581.json",#
"D2013-11-18-02_4609.json","D2013-11-18-03_4621.json","D2013-11-18-04_4641.json","D2013-11-18-05_4673.json",#
"D2013-11-18-06_4681.json","D2013-11-19-01_4705.json","D2013-11-19-02_4737.json","D2013-11-19-03_4741.json",#
"D2013-11-19-04_4769.json","D2013-11-19-05_4781.json","D2013-11-20-01_4801.json","D2013-11-20-02_4833.json",#
"D2013-11-20-03_4841.json","D2013-11-21-01_4866.json","D2013-11-21-02_4897.json","D2013-11-21-03_4901.json",#
"D2013-11-21-04_4929.json","D2013-11-21-05_4941.json","D2013-11-21-07_4993.json","D2013-11-22-01_5001.json",#
"D2013-11-22-02_5002.json","D2013-11-22-03_5003.json","D2013-11-26-04_5061.json","D2013-12-02-02_5153.json",#
"D2013-12-02-03_5161.json","D2013-12-02-04_5163.json","D2013-12-02-05_5164.json","D2013-12-02-06_5185.json",#
"D2013-12-05-01_5313.json","D2013-12-05-02_5321.json","D2013-12-06-01_5377.json","D2013-12-06-04_5441.json",#
"D2013-12-09-01_5473.json","D2013-12-09-02_5481.json","D2013-12-09-03_5505.json","D2013-12-09-04_5537.json",#
"D2013-12-09-05_5541.json","D2013-12-10-01_5569.json","D2013-12-10-02_5581.json","D2013-12-10-04_5633.json",#
"D2013-12-10-05_5641.json","D2013-12-10-06_5665.json","D2013-12-11-01_5697.json","D2013-12-11-02_5701.json",#
"D2013-12-11-03_5729.json","D2013-12-11-04_5741.json","D2013-12-11-05_5761.json","D2013-12-11-06_5793.json",#
"D2013-12-12-01_5801.json","D2013-12-12-03_5861.json","D2013-12-13-01_5889.json","D2013-12-13-02_5901.json",#
"D2013-12-13-03_5921.json","D2013-12-16-01_5953.json","D2013-12-16-02_5961.json","D2013-12-16-03_5985.json",#
"D2013-12-17-01_6061.json","D2013-12-17-02_6081.json","D2013-12-17-03_6113.json","D2013-12-18-01_6221.json",#
"D2013-12-18-02_6241.json","D2013-12-18-03_6273.json","D2013-12-19-03_6337.json")#
#
for (i in 1:80)#
{#
data1 = fromJSON(file=data_list[i], method="C", unexpected.escape="error") #
#
#The detail of the data format, see Hirokazu Shirado's json_format.rtf #
#Note: each graph data is the result AFTER cooperation and rewiring step. Therefore, if you want to know connections when players select cooperation or defection, you have to use the graph data of the PRECEDING round.#
#T500_1 is a list#
#Starting: gameId, scoreA, scoreB, profit, initDensity, percentA, showScore, cost#
#In $result: `0` to `10`#
#In each number: directed(always FALSE), graph (round number), nodes, links, multigraph(always FALSE)#
#In nodes of `0`: nodes[[i]]$id, initScore (i = 1-25)#
#In nodes of `1`-: nodes[[i]]$id, initScore, payoff, cumulativePayoff, behavior, behaviorTime, makeLink, notMakeLink, breakLink, notbreakLink #
#In links of `0`,`1`-: link[[j]]$id#
#
#1. Nodes data#
data2_r0 = as.data.frame(do.call("rbind", data1$result$`0`$nodes))#
data2_r1 = as.data.frame(do.call("rbind", data1$result$`1`$nodes))#
data2_r2 = as.data.frame(do.call("rbind", data1$result$`2`$nodes))#
data2_r3 = as.data.frame(do.call("rbind", data1$result$`3`$nodes))#
data2_r4 = as.data.frame(do.call("rbind", data1$result$`4`$nodes))#
data2_r5 = as.data.frame(do.call("rbind", data1$result$`5`$nodes))#
data2_r6 = as.data.frame(do.call("rbind", data1$result$`6`$nodes))#
data2_r7 = as.data.frame(do.call("rbind", data1$result$`7`$nodes))#
data2_r8 = as.data.frame(do.call("rbind", data1$result$`8`$nodes))#
data2_r9 = as.data.frame(do.call("rbind", data1$result$`9`$nodes))#
data2_r10 = as.data.frame(do.call("rbind", data1$result$`10`$nodes))#
data2_r0$cumulativePayoff = data2_r0$behaviorTime = data2_r0$notMakeLink = data2_r0$notBreakLink = data2_r0$behavior = data2_r0$breakLink = data2_r0$makeLink = data2_r0$payoff = NA  #
data2_r0 = data2_r0[,names(data2_r1)]#
data2_r0$round = 0#
data2_r1$round = 1#
data2_r2$round = 2#
data2_r3$round = 3#
data2_r4$round = 4#
data2_r5$round = 5#
data2_r6$round = 6#
data2_r7$round = 7#
data2_r8$round = 8#
data2_r9$round = 9#
data2_r10$round = 10#
data2 = rbind(data2_r0,data2_r1,data2_r2,data2_r3,data2_r4,data2_r5,data2_r6,data2_r7,data2_r8,data2_r9,data2_r10)#
data2$gameID = data1$gameId#
data2$scoreA = data1$scoreA#
data2$scoreB = data1$scoreB#
data2$percentA = data1$percentA#
data2$showScore = data1$showScore#
#
data2$initScore = unlist(data2$initScore)#
data2$cumulativePayoff = unlist(data2$cumulativePayoff)#
data2$behaviorTime = unlist(data2$behaviorTime)#
data2$behavior = unlist(data2$behavior)#
data2$id = unlist(data2$id)#
data2$payoff = unlist(data2$payoff)#
#
#2. Links data#
data3_r0 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`0`$links))$id),ncol=2,byrow=TRUE))#
data3_r1 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`1`$links))$id),ncol=2,byrow=TRUE))#
data3_r2 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`2`$links))$id),ncol=2,byrow=TRUE))#
data3_r3 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`3`$links))$id),ncol=2,byrow=TRUE))#
data3_r4 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`4`$links))$id),ncol=2,byrow=TRUE))#
data3_r5 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`5`$links))$id),ncol=2,byrow=TRUE))#
data3_r6 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`6`$links))$id),ncol=2,byrow=TRUE))#
data3_r7 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`7`$links))$id),ncol=2,byrow=TRUE))#
data3_r8 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`8`$links))$id),ncol=2,byrow=TRUE))#
data3_r9 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`9`$links))$id),ncol=2,byrow=TRUE))#
data3_r10 = as.data.frame(matrix(unlist(as.data.frame(do.call("rbind", data1$result$`10`$links))$id),ncol=2,byrow=TRUE))#
data3_r0$round = 0#
data3_r1$round = 1#
data3_r2$round = 2#
data3_r3$round = 3#
data3_r4$round = 4#
data3_r5$round = 5#
data3_r6$round = 6#
data3_r7$round = 7#
data3_r8$round = 8#
data3_r9$round = 9#
data3_r10$round = 10#
data3 = rbind(data3_r0,data3_r1,data3_r2,data3_r3,data3_r4,data3_r5,data3_r6,data3_r7,data3_r8,data3_r9,data3_r10)#
colnames(data3) = c("id1","id2","round")#
data3$gameID = data1$gameId#
data3$scoreA = data1$scoreA#
data3$scoreB = data1$scoreB#
data3$percentA = data1$percentA#
data3$showScore = data1$showScore#
#
if (i ==1)#
	{#
	data2_combined = data2#
	data3_combined = data3#
	}#
else#
	{#
	data2_combined = rbind(data2_combined,data2)#
	data3_combined = rbind(data3_combined,data3)#
	}#
print(i)#
}#
#
#save as R object #
ndata = data2_combined #node data#
ldata = data3_combined #link data#
#
#REPEAT: ndata and ldata#
ldata$game = NA #
ldata[ldata$gameID=="D2013-11-07-01_4227","game"] = 1#
ldata[ldata$gameID=="D2013-11-07-02_4257","game"] = 2#
ldata[ldata$gameID=="D2013-11-07-03_4261","game"] = 3#
ldata[ldata$gameID=="D2013-11-07-04_4289","game"] = 4#
ldata[ldata$gameID=="D2013-11-08-03_4353","game"] = 5#
ldata[ldata$gameID=="D2013-11-08-04_4354","game"] = 6#
ldata[ldata$gameID=="D2013-11-11-01_4361","game"] = 7#
ldata[ldata$gameID=="D2013-11-11-02_4385","game"] = 8#
ldata[ldata$gameID=="D2013-11-11-03_4417","game"] = 9#
ldata[ldata$gameID=="D2013-11-11-04_4421","game"] = 10#
ldata[ldata$gameID=="D2013-11-12-01_4449","game"] = 11#
ldata[ldata$gameID=="D2013-11-12-02_4461","game"] = 12 #
ldata[ldata$gameID=="D2013-11-14-01-4546","game"] = 13#
ldata[ldata$gameID=="D2013-11-15-01_4547","game"] = 14#
ldata[ldata$gameID=="D2013-11-16-01_4577","game"] = 15#
ldata[ldata$gameID=="D2013-11-16-02_4578","game"] = 16#
ldata[ldata$gameID=="D2013-11-18-01_4581","game"] = 17#
ldata[ldata$gameID=="D2013-11-18-02_4609","game"] = 18#
ldata[ldata$gameID=="D2013-11-18-03_4621","game"] = 19#
ldata[ldata$gameID=="D2013-11-18-04_4641","game"] = 20#
ldata[ldata$gameID=="D2013-11-18-05_4673","game"] = 21#
ldata[ldata$gameID=="D2013-11-18-06_4681","game"] = 22#
ldata[ldata$gameID=="D2013-11-19-01_4705","game"] = 23#
ldata[ldata$gameID=="D2013-11-19-02_4737","game"] = 24#
ldata[ldata$gameID=="D2013-11-19-03_4741","game"] = 25#
ldata[ldata$gameID=="D2013-11-19-04_4769","game"] = 26#
ldata[ldata$gameID=="D2013-11-19-05_4781","game"] = 27#
ldata[ldata$gameID=="D2013-11-20-01_4801","game"] = 28#
ldata[ldata$gameID=="D2013-11-20-02_4833","game"] = 29#
ldata[ldata$gameID=="D2013-11-20-03_4841","game"] = 30#
ldata[ldata$gameID=="D2013-11-21-01_4866","game"] = 31#
ldata[ldata$gameID=="D2013-11-21-02_4897","game"] = 32#
ldata[ldata$gameID=="D2013-11-21-03_4901","game"] = 33#
ldata[ldata$gameID=="D2013-11-21-04_4929","game"] = 34#
ldata[ldata$gameID=="D2013-11-21-05_4941","game"] = 35#
ldata[ldata$gameID=="D2013-11-21-07_4993","game"] = 36#
ldata[ldata$gameID=="D2013-11-22-01_5001","game"] = 37#
ldata[ldata$gameID=="D2013-11-22-02_5002","game"] = 38#
ldata[ldata$gameID=="D2013-11-22-03_5003","game"] = 39#
ldata[ldata$gameID=="D2013-11-26-04_5061","game"] = 40#
ldata[ldata$gameID=="D2013-12-02-02_5153","game"] = 41#
ldata[ldata$gameID=="D2013-12-02-03_5161","game"] = 42#
ldata[ldata$gameID=="D2013-12-02-04_5163","game"] = 43#
ldata[ldata$gameID=="D2013-12-02-05_5164","game"] = 44#
ldata[ldata$gameID=="D2013-12-02-06_5185","game"] = 45#
ldata[ldata$gameID=="D2013-12-05-01_5313","game"] = 46#
ldata[ldata$gameID=="D2013-12-05-02_5321","game"] = 47#
ldata[ldata$gameID=="D2013-12-06-01_5377","game"] = 48#
ldata[ldata$gameID=="D2013-12-06-04_5441","game"] = 49#
ldata[ldata$gameID=="D2013-12-09-01_5473","game"] = 50#
ldata[ldata$gameID=="D2013-12-09-02_5481","game"] = 51#
ldata[ldata$gameID=="D2013-12-09-03_5505","game"] = 52#
ldata[ldata$gameID=="D2013-12-09-04_5537","game"] = 53#
ldata[ldata$gameID=="D2013-12-09-05_5541","game"] = 54#
ldata[ldata$gameID=="D2013-12-10-01_5569","game"] = 55#
ldata[ldata$gameID=="D2013-12-10-02_5581","game"] = 56#
ldata[ldata$gameID=="D2013-12-10-04_5633","game"] = 57#
ldata[ldata$gameID=="D2013-12-10-05_5641","game"] = 58#
ldata[ldata$gameID=="D2013-12-10-06_5665","game"] = 59#
ldata[ldata$gameID=="D2013-12-11-01_5697","game"] = 60#
ldata[ldata$gameID=="D2013-12-11-02_5701","game"] = 61#
ldata[ldata$gameID=="D2013-12-11-03_5729","game"] = 62#
ldata[ldata$gameID=="D2013-12-11-04_5741","game"] = 63#
ldata[ldata$gameID=="D2013-12-11-05_5761","game"] = 64#
ldata[ldata$gameID=="D2013-12-11-06_5793","game"] = 65#
ldata[ldata$gameID=="D2013-12-12-01_5801","game"] = 66#
ldata[ldata$gameID=="D2013-12-12-03_5861","game"] = 67#
ldata[ldata$gameID=="D2013-12-13-01_5889","game"] = 68#
ldata[ldata$gameID=="D2013-12-13-02_5901","game"] = 69#
ldata[ldata$gameID=="D2013-12-13-03_5921","game"] = 70#
ldata[ldata$gameID=="D2013-12-16-01_5953","game"] = 71#
ldata[ldata$gameID=="D2013-12-16-02_5961","game"] = 72#
ldata[ldata$gameID=="D2013-12-16-03_5985","game"] = 73#
ldata[ldata$gameID=="D2013-12-17-01_6061","game"] = 74#
ldata[ldata$gameID=="D2013-12-17-02_6081","game"] = 75#
ldata[ldata$gameID=="D2013-12-17-03_6113","game"] = 76#
ldata[ldata$gameID=="D2013-12-18-01_6221","game"] = 77#
ldata[ldata$gameID=="D2013-12-18-02_6241","game"] = 78#
ldata[ldata$gameID=="D2013-12-18-03_6273","game"] = 79#
ldata[ldata$gameID=="D2013-12-19-03_6337","game"] = 80#
ldata$costbenefit = ifelse(ldata$game %in% 1:80, 50100, 1020)#
#REPEAT DONE #
#
ndata$game = NA #
ndata[ndata$gameID=="D2013-11-07-01_4227","game"] = 1#
ndata[ndata$gameID=="D2013-11-07-02_4257","game"] = 2#
ndata[ndata$gameID=="D2013-11-07-03_4261","game"] = 3#
ndata[ndata$gameID=="D2013-11-07-04_4289","game"] = 4#
ndata[ndata$gameID=="D2013-11-08-03_4353","game"] = 5#
ndata[ndata$gameID=="D2013-11-08-04_4354","game"] = 6#
ndata[ndata$gameID=="D2013-11-11-01_4361","game"] = 7#
ndata[ndata$gameID=="D2013-11-11-02_4385","game"] = 8#
ndata[ndata$gameID=="D2013-11-11-03_4417","game"] = 9#
ndata[ndata$gameID=="D2013-11-11-04_4421","game"] = 10#
ndata[ndata$gameID=="D2013-11-12-01_4449","game"] = 11#
ndata[ndata$gameID=="D2013-11-12-02_4461","game"] = 12 #
ndata[ndata$gameID=="D2013-11-14-01-4546","game"] = 13#
ndata[ndata$gameID=="D2013-11-15-01_4547","game"] = 14#
ndata[ndata$gameID=="D2013-11-16-01_4577","game"] = 15#
ndata[ndata$gameID=="D2013-11-16-02_4578","game"] = 16#
ndata[ndata$gameID=="D2013-11-18-01_4581","game"] = 17#
ndata[ndata$gameID=="D2013-11-18-02_4609","game"] = 18#
ndata[ndata$gameID=="D2013-11-18-03_4621","game"] = 19#
ndata[ndata$gameID=="D2013-11-18-04_4641","game"] = 20#
ndata[ndata$gameID=="D2013-11-18-05_4673","game"] = 21#
ndata[ndata$gameID=="D2013-11-18-06_4681","game"] = 22#
ndata[ndata$gameID=="D2013-11-19-01_4705","game"] = 23#
ndata[ndata$gameID=="D2013-11-19-02_4737","game"] = 24#
ndata[ndata$gameID=="D2013-11-19-03_4741","game"] = 25#
ndata[ndata$gameID=="D2013-11-19-04_4769","game"] = 26#
ndata[ndata$gameID=="D2013-11-19-05_4781","game"] = 27#
ndata[ndata$gameID=="D2013-11-20-01_4801","game"] = 28#
ndata[ndata$gameID=="D2013-11-20-02_4833","game"] = 29#
ndata[ndata$gameID=="D2013-11-20-03_4841","game"] = 30#
ndata[ndata$gameID=="D2013-11-21-01_4866","game"] = 31#
ndata[ndata$gameID=="D2013-11-21-02_4897","game"] = 32#
ndata[ndata$gameID=="D2013-11-21-03_4901","game"] = 33#
ndata[ndata$gameID=="D2013-11-21-04_4929","game"] = 34#
ndata[ndata$gameID=="D2013-11-21-05_4941","game"] = 35#
ndata[ndata$gameID=="D2013-11-21-07_4993","game"] = 36#
ndata[ndata$gameID=="D2013-11-22-01_5001","game"] = 37#
ndata[ndata$gameID=="D2013-11-22-02_5002","game"] = 38#
ndata[ndata$gameID=="D2013-11-22-03_5003","game"] = 39#
ndata[ndata$gameID=="D2013-11-26-04_5061","game"] = 40#
ndata[ndata$gameID=="D2013-12-02-02_5153","game"] = 41#
ndata[ndata$gameID=="D2013-12-02-03_5161","game"] = 42#
ndata[ndata$gameID=="D2013-12-02-04_5163","game"] = 43#
ndata[ndata$gameID=="D2013-12-02-05_5164","game"] = 44#
ndata[ndata$gameID=="D2013-12-02-06_5185","game"] = 45#
ndata[ndata$gameID=="D2013-12-05-01_5313","game"] = 46#
ndata[ndata$gameID=="D2013-12-05-02_5321","game"] = 47#
ndata[ndata$gameID=="D2013-12-06-01_5377","game"] = 48#
ndata[ndata$gameID=="D2013-12-06-04_5441","game"] = 49#
ndata[ndata$gameID=="D2013-12-09-01_5473","game"] = 50#
ndata[ndata$gameID=="D2013-12-09-02_5481","game"] = 51#
ndata[ndata$gameID=="D2013-12-09-03_5505","game"] = 52#
ndata[ndata$gameID=="D2013-12-09-04_5537","game"] = 53#
ndata[ndata$gameID=="D2013-12-09-05_5541","game"] = 54#
ndata[ndata$gameID=="D2013-12-10-01_5569","game"] = 55#
ndata[ndata$gameID=="D2013-12-10-02_5581","game"] = 56#
ndata[ndata$gameID=="D2013-12-10-04_5633","game"] = 57#
ndata[ndata$gameID=="D2013-12-10-05_5641","game"] = 58#
ndata[ndata$gameID=="D2013-12-10-06_5665","game"] = 59#
ndata[ndata$gameID=="D2013-12-11-01_5697","game"] = 60#
ndata[ndata$gameID=="D2013-12-11-02_5701","game"] = 61#
ndata[ndata$gameID=="D2013-12-11-03_5729","game"] = 62#
ndata[ndata$gameID=="D2013-12-11-04_5741","game"] = 63#
ndata[ndata$gameID=="D2013-12-11-05_5761","game"] = 64#
ndata[ndata$gameID=="D2013-12-11-06_5793","game"] = 65#
ndata[ndata$gameID=="D2013-12-12-01_5801","game"] = 66#
ndata[ndata$gameID=="D2013-12-12-03_5861","game"] = 67#
ndata[ndata$gameID=="D2013-12-13-01_5889","game"] = 68#
ndata[ndata$gameID=="D2013-12-13-02_5901","game"] = 69#
ndata[ndata$gameID=="D2013-12-13-03_5921","game"] = 70#
ndata[ndata$gameID=="D2013-12-16-01_5953","game"] = 71#
ndata[ndata$gameID=="D2013-12-16-02_5961","game"] = 72#
ndata[ndata$gameID=="D2013-12-16-03_5985","game"] = 73#
ndata[ndata$gameID=="D2013-12-17-01_6061","game"] = 74#
ndata[ndata$gameID=="D2013-12-17-02_6081","game"] = 75#
ndata[ndata$gameID=="D2013-12-17-03_6113","game"] = 76#
ndata[ndata$gameID=="D2013-12-18-01_6221","game"] = 77#
ndata[ndata$gameID=="D2013-12-18-02_6241","game"] = 78#
ndata[ndata$gameID=="D2013-12-18-03_6273","game"] = 79#
ndata[ndata$gameID=="D2013-12-19-03_6337","game"] = 80#
ndata$costbenefit = ifelse(ndata$game %in% 1:80, 50100, 1020)#
#
dim(ndata) #15258 individual-rounds with 18 variables (see the codebook)#
dim(ldata) #63309 tie-rounds with 10 variables (see the codebook)
save(ndata,file="node.Rdata") #node data saved (Please specify your directory)#
save(ldata,file="link.Rdata") #link data saved (Please specify your directory)
names(ndata)
names(ldata)
xtabs(~scoreA, ndata)
xtabs(~scoreB, ndata)
xtabs(~percentA, ndata)
xtabs(~showScore, ndata)
xtabs(~costbenefit, ndata)
xtabs(~game, ndata)
xtabs(~gameID, ndata)
head(ldata)
ldata[ldata$game==1 & ldata$round==0 & ldata$id1 == "p25" & ldata$id2,]
ldata[ldata$game==1 & ldata$round==0 & ldata$id1 == "p25" & ldata$id2 == "p6",]
head(ldata)
xtabs(~behavior, ndata)
summary(ndata$behaviorTime)
class(ndata$behaviorTime)
summary(as.numeric(ndata$behaviorTime))
(~payoff,ndata)
xtabs(~payoff,ndata)
tail(ndata)
